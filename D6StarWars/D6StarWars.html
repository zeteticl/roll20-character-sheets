<input class="toggle" name="attr_sheettype" type="hidden" value="0">

<input class="selector-switch gmroll" name="attr_gmrollswitch" type="checkbox" value="1">
<input class="selector-switch rollmod" name="attr_rollmodswitch" type="checkbox" value="1">

<input class="selector-switch force" name="attr_forceswitch" type="checkbox" value="1">
<input class="selector-switch background" name="attr_backgroundswitch" type="checkbox" value="1">
<input class="selector-switch equipment" name="attr_equipmentswitch" type="checkbox" value="1">
<input class="selector-switch cptracker" name="attr_cpswitch" type="checkbox" value="1" checked="checked">
<input class="selector-switch credittracker" name="attr_creditswitch" type="checkbox" value="1" checked="checked">


<div class="master-container">

	<!-- The "Settings Menu" Cog Icon -->
	<input class="main-options options-flag" type="checkbox" name="attr_options-flag"><span style="float:left">y</span>


<!-- Shows which sheet type is selected -->

	<div class="main-settings" style="height:1em;text-align:right;float:right;"><h2>Settings</h2></div>
	<div class="main-container pc right" style="position:absolute;right: 5px;top:-35px"><h2>Player Sheet</h2></div>
	<div class="main-container npc right" style="position:absolute;right: 5px;top:-35px"><h2>NPC Sheet</h2></div>
	<div class="main-container ship right" style="position:absolute;right: 5px;top:-35px"><h2>Ship</h2></div>
	<div class="main-container shop-inventory right" style="position:absolute;right: 5px;top:-35px"><h2>Shop/Container</h2></div>


	<div style="position:absolute;right: 5px;top:30px"><p class="version"> </p></div>

<!--  LOGO and dice images -->

	<div style="display:inline-block;position:absolute;left: 150px;padding-bottom:50px"> 
		<img src="http://rs8.pbsrc.com/albums/a35/VPP3/d62_zpstllyo5ds.png?w=480&h=480&fit=clip" style="max-height: 50px;"/>
		<img src="http://a.dilcdn.com/bl/wp-content/uploads/sites/6/2012/11/sw_logo_lg_default-small.jpg" style="max-height: 80px;" title="This is where the fun begins."/>
		<img src="http://rs8.pbsrc.com/albums/a35/VPP3/d61_zps5ef1qprz.png?w=480&h=480&fit=clip" style="max-height: 50px;"/>
	</div>

<!-- --------------------------------------------------------- SETTINGS MENU --------------------------------------- -->

	<div class="main-settings container" style="padding-top:67px">
		<div class="section" style="width:850px">

		<!-- Sheet type -->
			<div class="input-row top-row bold">
				<span title="Shows a more dense statblock for NPCs. Equipment sections uses the first field from the PC version">Sheet type: </span>
				<select name="attr_sheettype" style="width:90px;">
					<option value="0" selected="selected">PC</option>
					<option value="1">NPC</option>
					<option value="2">Ship</option>
					<option value="3">Container</option>
				</select>
			</div>

		<!-- GM roll toggle -->
			<div class="input-row top-row bold">
				<span title="Hides the GM rolls. They are like regular rolls but whispered to the GM">Hide GM Rolls?</span>
				<input name="attr_gmrollswitch" type="checkbox" value="1">
			</div>

		<!-- dice roll toggle -->
			<div class="input-row top-row bold">
				<span title="If checked, rolls don't ask for roll modifiers and rolls right away when selected.">Disable roll modification query when rolling?</span>
				<input name="attr_rollmodswitch" type="checkbox" value="1">
			</div>

		<!-- Wild Die toggle -->
			<div class="input-row top-row bold">
				<span title="If Wild Die isn't used, the die rolls wont explode or highlight critical successes nor failures">Use Wild Die in rolls?</span>
				<select name="attr_wilddie" style="width: 70px;">
					<option value="!cf1cs6" selected="selected">Yes</option>
					<option value="cf0cs0">No</option>
				</select>
			</div>

		<!-- Few optional sections to hide -->
			<div class="input-row top-row bold">
				<span title="Useful for those who are not Force-sensitive">Hide/Show Sections:</span>
			</div>
			<div class="input-row top-row bold">
				<span title="Useful for those who are not Force-sensitive">Hide Force Section? <input name="attr_forceswitch" type="checkbox" value="1"></span>
			</div>
			<div class="input-row top-row bold">
				<span>Hide Equipment Section? </span>
				<input name="attr_equipmentswitch" type="checkbox" value="1">
			</div>
			<div class="input-row top-row bold">
				<span>Hide Background Section? </span>
				<input name="attr_backgroundswitch" type="checkbox" value="1">
			</div>
			<div class="input-row top-row bold">
				<span>Hide Character Point Summary Section? </span>
				<input name="attr_cpswitch" type="checkbox" value="1" checked="checked">
			</div>
			<div class="input-row top-row bold">
				<span>Hide Credit Summary Section? </span>
				<input name="attr_creditswitch" type="checkbox" value="1" checked="checked">
			</div>
		</div>
	</div>

<!--  ---------------------------------------------- MAIN SHEET --------------------------------------------------------------------  -->

<div class="main-container container" style="padding-top:75px">
		
	<!-- ---------------------------- Player Core info ------------------ -->
		
		<div class="section pc">
			<div class="2colrow">
				<div class="col" style="display:inline-block;">
					<label class="toppad">Character Name <input class="right shorttext" type="text" name="attr_charactername" style="width:55%"/></label>
					<label class="toppad">Type <input class="right shorttext" type="text" name="attr_type" style="width:75%"/></label>
					<label class="toppad;">Species <input class="right shorttext" style="width:70%;" type="text" name="attr_species"/></label>
					<table style="margin-top:-10px; margin-left:-10px;">
						<tr>
							<td>
							<label class="toppad">Age <input  class="smalltext shorttext" type="text" name="attr_age"/></label>
							</td><td>
							<label>Height <input class="smalltext shorttext" type="text" name="attr_height"/></label>
							</td><td>
							<label>Weight <input class="smalltext shorttext" type="text" name="attr_weight"/></label>
							</td><td>
							<label>Gender <input class="mediumtext shorttext" type="text" name="attr_gender"/></label>
							</td>
						</tr>
					</table>
				</div>
				<div class="col">
					<label class="right">Credits <input type="number" min="0" class="credits" name="attr_credits" /></label>
					<label>Physical Description</label>
					<textarea name="attr_Physical_Description" style="height:6em;width:97%" ></textarea>
				</div>
			</div>
		</div>

	<!-- --------------------------- Player Secondary Info ------------------------- -->

		<div class="section pc">
			<div class='3colrow'>
				<div class='col'>
					<label class="areaLabel">Special Abilities</label>
					<textarea name="attr_specialAbilities" style="width:95%;height:13em" ></textarea>
				</div>
				<div class='col'>
					<label>Move <input type="number" name="attr_move" class="smallshortnumber" min="0" value="10"/></label>
					<label>Force Sensitive?
						<select name="attr_forceSensitive" class="smallselect">
						  <option value="1">Yes</option>
						  <option value="0" selected="selected">No</option>
						</select>
					</label>
					<label>Force Points <input type="number" name="attr_forcePoints" class="smallshortnumber" min="0" value="1"/></label> <!---On char creation everyone starts with 1 FP --->
					<label>Dark Side Points <input type="number" name="attr_darkSidePoints" class="smallshortnumber" min="0" value="0"/></label>
					<label>Character Points <input type="number" name="attr_characterPoints" class="smallshortnumber" min="0" value="0"/></label> <!---On char creation everyone starts with 5 CP --->
					<button class="d6-dice gmroll-hide" type="roll" name="rollg_customroll" value="/w gm &{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}"><span class="redtxt">(GM)</span>Custom Roll</button>
					<button class="d6-dice gmroll-hide" type="roll" name="rollg_extraroll" value="/w gm &{template:black} {{name=Extra Dice}} {{Roll=[[{?{Number of  extra dice|0}d6cf0cs7}]]}}"><span class="redtxt">(GM)</span>Extra Dice</button>
					<button class="d6-dice gmroll-hide" type="roll" name="rollg_charproll" value="/w gm &{template:black} {{name=Character points roll}} {{Roll=[[?{Number of char points to spend on roll|1|2|3|4|5}d6!cf0cs6]]}}"><span class="redtxt">(GM)</span>Char pt</button>
				</div>         
				<div class='col'>
					<label style="text-decoration:underline;">Wound Level
						<select name="attr_WoundLevel" class="mediumselect left" style="width:135px"/>
						  <option value="0" selected="selected">Healthy</option>
						  <option value="1">Stunned</option>
						  <option value="1">Wounded</option>
						  <option value="2">Wounded Twice</option>
						  <option value="5">Incapacitated</option> <!-- You shouldn't even be able to make checks while incapacitated or Mortally wounded, hence -5. -->
						  <option value="5">Mortally Wounded</option>
						</select>
					</label>
					<label>Initiative bonus
						<input type="number" name="attr_initiative" class="smallnumber shortnumber" min="0" value="0"/>D+<input type="number" name="attr_initiativepip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
					</label>
					<button class="d6-dice rollmod" type="roll" name="roll_init" value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie} &{tracker}]]}}">Initiative</button>
					<button class="d6-dice rollmod-no" type="roll" name="roll_initnomod" value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + 1d6@{wilddie} &{tracker}]]}}">Initiative</button>
					<button class="d6-dice" type="roll" name="roll_customroll" value="&{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}">Custom Roll(no modifiers)</button>
					<button class="d6-dice" type="roll" name="roll_extraroll" value="&{template:black} {{name=Extra Dice}} {{Roll=[[{?{Number of  extra dice|0}d6cf0cs7}]]}}">Extra Dice(no wild die)</button>
					<button class="d6-dice" type="roll" name="roll_charproll" value="&{template:black} {{name=Character points roll}} {{Roll=[[?{Number of char points to spend on roll|1|2|3|4|5}d6!cf0cs6]]}}">Character points roll</button>
				</div>
			</div>
		</div>


	<!-- ------------------------------ NPC info block ------------------------------ -->	

		<div class="section npc"> 
			<div class="2colrow">
				<div class="col" style="display:inline-block;">
					<label class="toppad">NPC Name <input class="right shorttext" type="text" name="attr_charactername" style="width:65%"></label>
					<label style="text-decoration:underline;">Wound Level
						<select name="attr_WoundLevel" class="mediumselect left" style="width:135px"/>
						  <option value="0" selected="selected">Healthy</option>
						  <option value="1">Stunned</option>
						  <option value="1">Wounded</option>
						  <option value="2">Wounded Twice</option>
						  <option value="5">Incapacitated</option> <!--You shouldn't even be able to make checks while incapacitated or Mortally wounded, hence -15. Later will include option to ignore wound penalties -->
						  <option value="5">Mortally Wounded</option>
						</select>
					</label>
					<label>Initiative bonus<input type="number" name="attr_initiative" class="smallnumber shortnumber" min="0" value="0">D+<input type="number" name="attr_initiativepip" class="pipnumber shortnumber" min="0" max="2" value="0"></label>
					<button class="d6-dice rollmod-no" type="roll" name="roll_init_n" value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + 1d6@{wilddie} &{tracker}]]}}"/>Initiative</button>

					<button class="d6-dice rollmod" type="roll" name="roll_init_n" value="&{template:black} {{name=Initiative}} {{Roll=[[(@{perception} + @{initiative} -@{WoundMod} + @{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perceptionpip} + @{initiativepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie} &{tracker}]]}}"/>Initiative</button>
					<button class="d6-dice" type="roll" name="roll_customroll_n" value="&{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}"/>Custom Roll(no mods)</button>
					<button class="d6-dice gmroll-hide" type="roll" name="rollg_customroll_n" value="/w gm &{template:black} {{name=?{Roll Name}}} {{Roll=[[{(?{Number of dice|0} - 1)d6cf0cs7 + ?{Number of pip|0},1d6@{wilddie}}]]}}"/><span class="redtxt">(GM)</span>C Roll</button>
				</div>
				<div class="col">
					<label>Physical Description & Other Info</label>
					<textarea name="attr_Physical_Description" style="height:6em;width:97%"></textarea>
				</div>
			</div>
		</div>

		<div class="section shop-inventory">
			<label><input type="text" name="attr_containername"></label>
		</div>

	<!-- ---------------------------------------------- Attributes&Skills ----------------------------------- -->

		<div class="section pc npc"> 
			<div class="flex-box">
				<div class="flex-col">

						<!---Dex Attribute --->

							<div class="tdborder"> 
										<div class="bold">
											<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexteritypip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" >Dexterity</button>
											<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexteritypip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" ><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexteritypip} + 1d6@{wilddie}]]}}" >Dexterity</button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Dexterity}} {{Roll=[[(@{dexterity} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexteritypip} + 1d6@{wilddie}]]}}" ><span class="redtxt">GM</span></button>
											<div style="float:right;">
												<input type="number" name="attr_dexterity" class="smallnumber" min="1" value="3"/>D+<input type="number" name="attr_dexteritypip" class="pipnumber" min="0" max="2" value="0"/>
											</div>
										</div>
										<fieldset class="repeating_dexskills"> <!---Dex Skills --->
											<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{dexskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexskillpip} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{dexskillname}}} {{Roll=[[(@{dexskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{dexskillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
												<input class="skilltext" type="text" name="attr_dexskillname"/>
												<div class="right">
												<input type="number" name="attr_dexskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_dexskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
												</div>
										</fieldset>
							</div>
					
					<!---Know Attribute --->

							<div class="tdborder"> 
										<div class="bold">
											<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowledgepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" >Knowledge</button>
											<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowledgepip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowledgepip} + 1d6@{wilddie}]]}}" >Knowledge</button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Knowledge}} {{Roll=[[(@{knowledge} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowledgepip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											<div style="float:right;">
												<input type="number" name="attr_knowledge" class="smallnumber" min="1" value="3"/>D+<input type="number" name="attr_knowledgepip" class="pipnumber" min="0" max="2" value="0"/>
											</div>
										</div>
										<fieldset class="repeating_knowskills">  <!---Know Skills --->
											<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{knowskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowskillpip} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{knowskillname}}} {{Roll=[[(@{knowskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{knowskillpip}+ 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											<input class="skilltext" type="text" name="attr_knowskillname"/>
											<div class="right">
												<input type="number" name="attr_knowskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_knowskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
											</div>
										</fieldset>
							</div>

						<!---Mech Attribute --->

							<div class="tdborder">
									<div class="bold">
											<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechanicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">Mechanical</button>
											<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechanicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" ><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechanicalpip} + 1d6@{wilddie}]]}}">Mechanical</button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=Mechanical}} {{Roll=[[(@{mechanical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechanicalpip} + 1d6@{wilddie}]]}}" ><span class="redtxt">GM</span></button>
											<div style="float:right;">
												<input type="number" name="attr_mechanical" class="smallnumber" min="1" value="3"/>D+<input type="number" name="attr_mechanicalpip" class="pipnumber" min="0" max="2" value="0"/>
											</div>
										</div>
										<fieldset class="repeating_mechskills">  <!---Mech Skills --->
											<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{mechskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up}-1)d6cf0cs7 + @{mechskillpip} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{mechskillname}}} {{Roll=[[(@{mechskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{mechskillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											<input class="skilltext" type="text" name="attr_mechskillname"/>
											<div class="right">
												<input type="number" name="attr_mechskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_mechskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
											</div>
										</fieldset>
							</div>
				</div>


				<div class="flex-col">

						<!---Perc Attribute --->

							<div class="tdborder">
								<div class="bold">
										<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs7 +@{perceptionpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}" >Perception</button>
										<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs7 +@{perceptionpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

										<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 +@{perceptionpip} +1d6@{wilddie}]]}}" >Perception</button>
										<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Perception}} {{Roll=[[(@{perception} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 +@{perceptionpip} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
										<div style="float:right;">
											<input type="number" name="attr_perception" class="smallnumber"  min="1" value="3"/>D+<input type="number" name="attr_perceptionpip" class="pipnumber" min="0" max="2" value="0"/>
										</div>
								</div>
									<fieldset class="repeating_perckills"> <!---Perc Skills --->
										<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perckillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
										<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{perckillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

										<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{perckillpip} + 1d6@{wilddie}]]}}"></button>
										<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{perckillname}}} {{Roll=[[(@{perckilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{perckillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											<input class="skilltext" type="text" name="attr_perckillname"/> <!-- Misspelled attr name iis to be left as it is, otherwise it wipes char sheets from perseption skills-->
											<div class="right">
											<input type="number" name="attr_perckilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_perckillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
											</div>
									</fieldset>
							</div>
							
						<!---Str Attribute --->

							<div class="tdborder">
								<div class="bold">
										<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strengthpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" >Strength</button>
										<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strengthpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

										<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strengthpip} + 1d6@{wilddie}]]}}" >Strength</button>
										<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Strength}} {{Roll=[[(@{strength} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strengthpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
										<div style="float:right;">
											<input type="number" name="attr_strength" class="smallnumber" min="1" value="3"/>D+<input type="number" name="attr_strengthpip" class="pipnumber" min="0" max="2" value="0"/>
										</div>
									</div>
									<fieldset class="repeating_strskills"> <!---Str Skills --->
										<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
										<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{strskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

										<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up}-1)d6cf0cs7 + @{strskillpip} + 1d6@{wilddie}]]}}"></button>
										<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=@{strskillname}}} {{Roll=[[(@{strskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{strskillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
										  <input class="skilltext" type="text" name="attr_strskillname"/>
										  <div class="right">
											<input type="number" name="attr_strskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_strskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
										  </div>
									</fieldset>
							</div>

						<!---Tech Attribute --->

							<div class="tdborder">
									<div class="bold">
											<button class="d6-dice rollmod" type="roll" value="&{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{technicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}" >Technical</button>
											<button class="d6-dice rollmod gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{technicalpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no" type="roll" value="&{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{technicalpip} + 1d6@{wilddie}]]}}" >Technical</button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide" type="roll" value="/w gm &{template:blue} {{name=Technical}} {{Roll=[[(@{technical} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{technicalpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											<div style="float:right;">
												<input type="number" name="attr_technical" class="smallnumber" min="1" value="3"/>D+<input type="number" name="attr_technicalpip" class="pipnumber" min="0" max="2" value="0"/>
											</div>
										</div>
										<fieldset class="repeating_techskills">  <!---Tech Skills --->
											<button class="d6-dice rollmod"  type="roll" value="&{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{techskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs7 + @{techskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

											<button class="d6-dice rollmod-no"  type="roll" value="&{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{techskillpip} + 1d6@{wilddie}]]}}"></button>
											<button class="d6-dice rollmod-no gmroll gmroll-hide"  type="roll" value="/w gm &{template:blue} {{name=@{techskillname}}} {{Roll=[[(@{techskilldice} -@{WoundMod} +@{Force_Up} -1)d6cf0cs7 + @{techskillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
											  <input class="skilltext" type="text" name="attr_techskillname"/>
											  <div class="right">
												<input type="number" name="attr_techskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_techskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
											  </div>
										</fieldset>
							</div>
				</div>
			</div>  <!-- flexbox-->
		</div>

	<!-- -------------------------------------------------- Weapons & Armor --------------------------- -->

		<div class="section pc npc shop-inventory"> 
			<label style="text-align: center">Weapon & Armor</label>
			<table>
				<tr>
					<td style="width:210px"><label>Weapon</label></td>
					<td style="width:70px">Skill Roll</td>
					<td style="width:72px">Damage</td>
					<td style="width:45px">Short</td>
					<td style="width:50px">Med</td>
					<td style="width:45px">Long</td>
					<td style="width:35px">ROF</td>
					<td style="width:30px;text-align:center;">Ammo</td>
				</tr>
			</table>
				<fieldset class="repeating_weapons">
					<input class="skilltext" type="text"  style="width:200px" name="attr_weapon"/>
					<input type="number" name="attr_weaponskill" class="smallnumber" min="1" value="1"/>D+<input type="number" name="attr_weaponskillpip" class="pipnumber" min="0" max="2" value="0"/>
					<input type="number" name="attr_damagedice" class="smallnumber shortnumber" min="1" value="1"/>D+<input type="number" name="attr_damagepip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
					<input class="smallnumber shortnumber" type="number" name="attr_shortrange"/>
					<input class="mediumnumber shortnumber" type="number" name="attr_medrange"/>
					<input class="mediumnumber shortnumber" type="number" name="attr_longrange"/>
					<input class="smallnumber shortnumber" type="number" name="attr_ROF"/>
					<input class="mediumnumber shortnumber" type="number" name="attr_Ammo"/>
				<!-- roll buttons with roll queries -->
					<button class="d6-dice rollmod" name="roll_attack" type="roll" value="&{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs0 + @{weaponskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}">Atk</button>
					<button class="d6-dice rollmod-no" name="roll_attack" type="roll" value="&{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{weaponskillpip} + 1d6@{wilddie}]]}}">Atk</button>

		
					<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_attack" type="roll" value="/w gm &{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} + ?{Dice mods|0} -1)d6cf0cs0 + @{weaponskillpip} + ?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>Atk</button>
					<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_attack" type="roll" value="/w gm &{template:red} {{name=@{weapon}}} {{Roll=[[(@{weaponskill} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{weaponskillpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>Atk</button>

					<button class="d6-dice" name="roll_dmg" type="roll" value="&{template:red} {{name=@{weapon} damage}} {{Roll=[[(@{damagedice}- 1)d6cf0cs7 + @{damagepip} + (1d6@{wilddie})]]}}">Dmg</button>
					<button class="d6-dice gmroll gmroll-hide" name="rollg_dmg" type="roll" value="/w gm &{template:red} {{name=@{weapon} damage}} {{Roll=[[(@{damagedice}- 1)d6cf0cs7 + @{damagepip} + (1d6@{wilddie})]]}}"><span class="redtxt">GM</span>Dmg</button>								
				</fieldset>
			<table>
				<tr>
					<td style="width:200px"><label>Armor</label></td>
					<td style="width:80px">Physical</td>
					<td style="width:80px">Energy</td>
					<td style="width:180px">Other</td>
					<td style="width:180px">Damage Soak Rolls</td>
				</tr>
			</table>
				<fieldset class="repeating_armors">
					<input class="skilltext" type="text"  style="width:200px" name="attr_armorname"/>
					<input type="number" name="attr_armorPhDice" class="smallnumber shortnumber" min="0" value="1"/>D+<input type="number" name="attr_armorPhPip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
					<input type="number" name="attr_armorEnDice" class="smallnumber shortnumber" min="0" value="1"/>D+<input type="number" name="attr_armorEnPip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
					<input class="skilltext" type="text" name="attr_armor_other"/>
					<button class="d6-dice rollmod-no physical" name="roll_dmg_soak_en" type="roll" value="&{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +1d6@{wilddie}]]}}">t</button>
					<button class="d6-dice rollmod-no energy" name="roll_dmg_soak_ph" type="roll" value="&{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} -1)d6cf0cs0 +@{strengthpip} +@{armorEnPip} +1d6@{wilddie}]]}}">e</button>
					<button class="d6-dice rollmod-no" name="roll_dmg_soak_str" type="roll" value="&{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} -1)d6cf0cs0 +@{strengthpip} +1d6@{wilddie}]]}}">Str only</button>

					<button class="d6-dice rollmod-no gmroll physical gmroll-hide" name="rollg_dmg_soak_en" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} -1)d6cf0cs0 +@{strengthpip} + @{armorPhPip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>t</button>
					<button class="d6-dice rollmod-no gmroll energy gmroll-hide" name="rollg_dmg_soak_ph" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} -1)d6cf0cs0 +@{strengthpip} + @{armorEnPip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>e</button>
					<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_dmg_soak_str" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} -1)d6cf0cs0 +@{strengthpip} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>S</button>

					<button class="d6-dice rollmod physical" name="roll_dmg_soak_en" type="roll" value="&{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">t</button>
					<button class="d6-dice rollmod energy" name="roll_dmg_soak_ph" type="roll" value="&{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorEnPip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">e</button>
					<button class="d6-dice rollmod" name="roll_dmg_soak_str" type="roll" value="&{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}">Str only</button>

					<button class="d6-dice rollmod-no gmroll physical gmroll-hide" name="rollg_dmg_soak_en" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Physical)}} {{Roll=[[(@{strength} +@{armorPhDice} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +@{armorPhPip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>t</button>
					<button class="d6-dice rollmod-no gmroll energy gmroll-hide" name="rollg_dmg_soak_ph" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Energy)}} {{Roll=[[(@{strength} +@{armorEnDice} +?{Dice mods|0} -1)d6cf0cs0  +@{strengthpip} +@{armorEnPip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>e</button>
					<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_dmg_soak_str" type="roll" value="/w gm &{template:red} {{name=Damage Soak(Strength only)}} {{Roll=[[(@{strength} +?{Dice mods|0} -1)d6cf0cs0 +@{strengthpip} +?{Other Mods(pip)|0} + 1d6@{wilddie}]]}}"><span class="redtxt">GM</span>S</button>		  
				</fieldset>
		</div>

	<!-- ------------------------------------------------ Force Section ----------------------------- -->

		<div class="section force-hide pc npc"> 
			<label style="text-align: center">Force Section</label>
			<div class='3colrow'>
				<div class='col'>
					<table style="width:270px"><th><label>Force Skills</label></th>
						<tr><!--Control -->
							<td class="tdborder">
								<div class="bold">
									<button class="d6-dice rollmod forcebutton" name="roll_force_control" type='roll' value='&{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>Control</button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_control" type='roll' value='/w gm &{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>

									<button class="d6-dice rollmod-no forcebutton" name="roll_force_control" type='roll' value='&{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod}  +1d6@{wilddie}]]}}'>Control</button>
									<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_force_control" type='roll' value='/w gm &{template:default} {{name=Force:Control}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>
									<div class="bold" style="float:right;">
										<input type="number" name="attr_control" class="smallnumber"  min="0" value="0"/>D+<input type="number" name="attr_controlpip" class="pipnumber" min="0" max="2" value="0"/>
									</div>
								</div>
								<fieldset class="repeating_controlpowers">  <!---Control Powers --->      
									<button class="d6-dice rollmod" name="roll_force_control_p" type="roll" value="&{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_control_p" type="roll" value="/w gm &{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
									<input class="skilltext" type="text" name="attr_controlpowername"/> 

									<button class="d6-dice rollmod-no" name="roll_force_control_p" type="roll" value="&{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_force_control_p" type="roll" value="/w gm &{template:default} {{name=@{controlpowername} (Control)}} {{Roll=[[(@{control} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{controlpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
									<input class="skilltext" type="text" name="attr_controlpowername"/> 
								</fieldset>								
							</td>
						</tr>
						<tr><!-- Sense -->
							<td class="tdborder">
								<div class="bold">
									<button class="d6-dice rollmod forcebutton" name="roll_force_sense" type='roll' value='&{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>Sense</button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_sense" type='roll' value='/w gm &{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>

									<button class="d6-dice rollmod-no forcebutton" name="roll_force_sense" type='roll' value='&{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>Sense</button>
									<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_force_sense" type='roll' value='/w gm &{template:default} {{name=Force:Sense}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>
									<div class="bold" style="float:right;">
										<input type="number" name="attr_sense" class="smallnumber" style="margin-left=100px;"  min="0" value="0"/>D+<input type="number" name="attr_sensepip" class="pipnumber" min="0" max="2" value="0"/>
									</div>
								</div>
								<fieldset class="repeating_sensepowers">  <!---Sense Powers --->      
									<button class="d6-dice rollmod" name="roll_force_sense_p" type="roll" value="&{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_sense_p"  type="roll" value="/w gm &{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

									<button class="d6-dice rollmod-no" name="roll_force_sense_p" type="roll" value="&{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_force_sense_p"  type="roll" value="/w gm &{template:default} {{name=@{sensepowername} (Sense)}} {{Roll=[[(@{sense} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{sensepip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
									<input class="skilltext" type="text" name="attr_sensepowername"/> 
								</fieldset>
							</td>
						</tr>
						<tr><!-- Alter -->
							<td class="tdborder">
								<div class="bold">
									<button class="d6-dice rollmod forcebutton" name="roll_force_alter" type='roll' value='&{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'>Alter</button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_alter"  type='roll' value='/w gm &{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>

									<button class="d6-dice rollmod-no forcebutton" name="roll_force_alter" type='roll' value='&{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up}-1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'>Alter</button>
									<button class="d6-dice rollmod-no  gmroll gmroll-hide" name="rollg_force_alter"  type='roll' value='/w gm &{template:default} {{name=Force:Alter}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up}-1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}'><span class="redtxt">GM</span></button>
									<div class="bold" style="float:right;">
										<input type="number" name="attr_alter" class="smallnumber" min="0" value="0"/>D+<input type="number" name="attr_alterpip" class="pipnumber" min="0" max="2" value="0"/>
									</div>
								</div>
								<fieldset class="repeating_alterpowers">  <!---Alter Powers --->      
									<button class="d6-dice rollmod"  type="roll" name="roll_force_alter_p" value="&{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 + @{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod gmroll gmroll-hide" name="rollg_force_alter_p"  type="roll" value="/w gm &{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} +?{Dice mods|0} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +?{Other Mods(pip)|0} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>

									<button class="d6-dice rollmod-no"  type="roll" name="roll_force_alter_p" value="&{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 + @{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"></button>
									<button class="d6-dice rollmod-no gmroll gmroll-hide" name="rollg_force_alter_p"  type="roll" value="/w gm &{template:default} {{name=@{alterpowername} (Alter)}} {{Roll=[[(@{alter} -@{WoundMod} +@{Force_Up} -1)d6cf0cs0 +@{alterpip} +@{Force_EmptinessMod} +1d6@{wilddie}]]}}"><span class="redtxt">GM</span></button>
									<input class="skilltext" type="text" name="attr_alterpowername"/> 
								</fieldset>
							</td>
						</tr>
					</table>
				</div>
				<div class='col'><!-- Force Power Trackers -->
					<table style="position:relative;left:30px"><th><label>Force Powers Active</label></th>
						<tr><td><!---Force Emptiness --->
								<span style="padding-top:8px; padding-bottom:12px;" title="Force Emptiness adds +6 pips to all force skill rolls when active. Bonus is reduced by 1 for every DSP">Force Emptiness active</span><!---Force Emptiness adds +6 pips to all force skill rolls when active --->
									<select name="attr_Force_Emptiness" class="smallselect">
									  <option value="false" selected="selected">No</option>
									  <option value="true">Yes</option>
									</select>
						</td></tr>
						<tr><td><!---Force Powers active --->
							<span>Resist Pain active<!---Reduces Wound penalties to -1. Doesn't need to be counted on the tracker below --->
								<select name="attr_PainResist" class="smallselect" title="Reduces Wound penalties to -1. Doesn't need to be counted on the tracker below">
								  <option value="false" selected="selected">No</option>
								  <option value="true">Yes</option>
								</select>
							</span>
						</td></tr>
						<tr><td><!---Force Powers active --->
							<span># of other powers active<!---gives penalty to all rolls thanks to concentration/distraction --->
								<select name="attr_Force_Up" class="smallselect" title="The number of power active is subtracted from all roll as a Multiple Action Penalty. Above Force Pain doesn't need to be added">
								  <option value="0" selected="selected">0</option>
								  <option value="-1">1</option>
								  <option value="-2">2</option>
								  <option value="-3">3</option>
								  <option value="-4">4</option>
								  <option value="-5">5</option>
								</select>
							</span>
						</td></tr>
					</table>
				</div>
				<div class='col'><!-- Force Power list -->
						<label style="padding-top:8px; padding-bottom:12px;" >Force Powers</label>
						<textarea name="attr_forcePowers" style="width:95%;height:24em"></textarea>
				</div>
			</div>
			<br>
			<br>
			<div class='col'>
					<span style="padding-top:8px; padding-bottom:12px;" >Lightsaber Combat
						<input class="skilltext" type="text" name="attr_lightsaberskill" value="lightsaber"/>
						<input type="number" name="attr_lightsaberskilldice" class="smallnumber shortnumber" min="1" value="3"/>D+<input type="number" name="attr_lightsaberskillpip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
						<button class="d6-dice rollmod" name="roll_lc_attack" type="roll" value="&{template:default} {{name=@{lightsaberskill}}} {{Roll=[[(@{lightsaberskilldice} -@{WoundMod} +@{Force_Up} +@{sense} +?{Dice mods|0} -1)d6cf0cs0 + @{lightsaberskillpip} +@{Force_EmptinessMod} +@{sensepip} +?{Other Mods(pip)|0} +(1d6@{wilddie})]]}}">LC Attack</button>
						<button class="d6-dice rollmod-no" name="roll_lc_attack" type="roll" value="&{template:default} {{name=@{lightsaberskill}}} {{Roll=[[(@{lightsaberskilldice} -@{WoundMod} +@{Force_Up} +@{sense} -1)d6cf0cs0 + @{lightsaberskillpip} +@{Force_EmptinessMod} +@{sensepip} +(1d6@{wilddie})]]}}">LC Attack</button>
						<input type="number" name="attr_lightsaberdamagedice" class="smallnumber shortnumber" min="1" value="6"/>D+<input type="number" name="attr_lightsaberdamagepip" class="pipnumber shortnumber" min="0" max="2" value="0"/>
						<button class="d6-dice rollmod" name="roll_lc_dmg" type="roll" value="&{template:default} {{name=@{lightsaberskill} damage}} {{Roll=[[(@{lightsaberdamagedice}- 1)d6cf0cs0 +@{lightsaberdamagepip} +@{Force_EmptinessMod} +(1d6@{wilddie})]]}}">LC Damage</button>
					</span>		
			</div>
		</div>

	<!-- ---------------------------------------------------------- Equipment PC ------------------------------------------- -->

		<div class="section equipment-hide pc shop-inventory"> 
				<label style="text-align: center;">Equipment</label>
				<table style="width:97%">
					<tr>
						<td style="text-align: right;">
							<textarea name="attr_geartext1"></textarea>
							<textarea name="attr_geartext2"></textarea>
						</td>
						<td style="text-align: center;">
							<textarea name="attr_geartext3"></textarea>
							<textarea name="attr_geartext4"></textarea>
						</td>
						<td style="text-align: Left;">
							<textarea name="attr_geartext5"></textarea>
							<textarea name="attr_geartext6"></textarea>
						</td>
					</tr>
				</table>
		</div>

	<!-- ---------------------------------------------------------- Equipment NPC ------------------------------------------- -->

		<div class="section equipment-hide npc" >
				<label style="text-align: center">Equipment</label>
				<textarea style="height:7em;width:96%" name="attr_geartext1"></textarea>
		</div>


	<!-- ---------------------------------------------------------- Background & extended info------------------------------------ -->

		<div class="section background-hide pc npc">
			<label style="text-align: center">Background and extended info</label>
			<table>
				<tr>
					<td style="width:33.33%;"><label>Background</label>
						<div>
							<textarea name="attr_background"></textarea>
						</div>
					</td>
					<td style="width:33.33%;">
						<label>Personality</label>
						<div>
							<textarea name="attr_personality"></textarea>
						</div>
					</td>
					<td style="width:33.33%;">
						<label>Objectives</label>
						<div>
							<textarea name="attr_objectives"></textarea>
						</div>
					</td>
				</tr>
				<tr>
					<td>
						<label>Quotes</label>
						<div>
							<textarea name="attr_quotes"></textarea>
						</div>
					</td>
					<td>
						<label>Connections to other characters</label>
						<div>
							<textarea name="attr_connections"></textarea>
						</div>
					</td>
					<td>
						<label>Additional Notes</label>
						<div>
							<textarea name="attr_notes"></textarea>
						</div>
					</td>
				</tr>
			</table>
		</div>

	<!-- --------------------------------------------------Character Point tracking------------------------------------ -->

	<div class="section cptracker-hide pc">
		<label>Character Point Tracker</label>
		<span class="bold">Character Point Balance:</span>
		<span class="num" name="attr_cp_spent"></span>
		<fieldset class="repeating_cptable">
				<div style="padding-top: 8px;">
					<input type="text" name="attr_cp_desc" style="width:80%;">
					<input type="number" name="attr_cp_amount">
				</div>
		</fieldset>
	</div>

	<!-- ---------------------------------------------------------- Credit tracking------------------------------------ -->

	<div class="section credittracker-hide pc">
		<label>Credit Tracker</label>
		<span class="bold">Credit Balance:</span>
		<span class="num credits" name="attr_credit_spent"></span>
		<fieldset class="repeating_credittable">
			<div style="padding-top: 8px;">
				<input type="text" name="attr_credit_desc" style="width:80%;">
				<input type="number" name="attr_credit_amount" style="width:100px;">
			</div>
		</fieldset>
	</div>

	<!-- ---------------------------------------------------------- Ship Core info------------------------------------ -->

		<div class="section ship shipinfo">
			<span class="bold">Starship:<input type="text" name="attr_ship_name" style="width:350px"></span>
			<br>
			<span class="bold">Craft:<input type="text" name="attr_ship_craft"></span>
			<span class="bold">Type:<input type="text" name="attr_ship_type"></span>
			<br>
			<span class="bold">Scale:<input type="text" name="attr_ship_scale" ></span>
			<span class="bold">Length:<input type="text" name="attr_ship_length" ></span>
			<br>
			<span class="bold">Crew:<input type="number" name="attr_ship_crew" class="mediumnumber"></span>
			<span class="bold">Skill:<input type="text" name="attr_ship_skill"></span>
			<br>
			<span class="bold">Passangers:<input type="number" name="attr_ship_passangers" class="mediumnumber"></span>
			<span class="bold">Cargo Capacity:<input type="text" name="attr_ship_cargo_capacity"></span>
			<span class="bold">Consumables:<input type="text" name="attr_ship_consumables"></span>
			<br>
			<span class="bold">Hyperdrive Multipiler:<input type="text" name="attr_hyperdrive_multi" step="any"></span>
			<span class="bold">Hyperdrive Backup:<input type="text" name="attr_hyperdrive_backup"></span>
			<span class="bold">Nav Computer:<input type="text" name="attr_nav_computer"></span>
			<br>
			<span class="bold">Maneuverability:<input type="text" name="attr_maneuverability"></span>
			<br>
			<span class="bold">Space:<input type="text" name="attr_ship_space"></span>
			<span class="bold">Athmosphere:<input type="text" name="attr_ship_athmosphere"></span>
			<br>
			<span class="bold">Hull:<input type="text" name="attr_ship_hull"></span>
			<span class="bold">Shields:<input type="text" name="attr_ship_shields"></span>
		</div>

	<!-- ---------------------------------------------------------- Ship Sensors------------------------------------ -->

		<div class="section ship">
			<label>Sensors</label>
			<span class="bold">Passive:<input type="number" name="attr_sensor_passive" class="smallnumber"/>/<input type="number" name="attr_sensor_passive_max" class="smallnumber"/></span>
			<span class="bold">Scan:<input type="number" name="attr_sensor_scan" class="smallnumber"/>/<input type="number" name="attr_sensor_scan_max" class="smallnumber"/></span>
			<span class="bold">Search:<input type="number" name="attr_sensor_search" class="smallnumber"/>/<input type="number" name="attr_sensor_search_max" class="smallnumber"/></span>
			<span class="bold">Focus:<input type="number" name="attr_sensor_focus" class="smallnumber"/>/<input type="number" name="attr_sensor_focus_max" class="smallnumber"/></span>
		</div>

	<!-- ---------------------------------------------------------- Ship Weapons------------------------------------ -->

		<div class="section ship">
			<label>Ship Weapons</label>
			<fieldset class="repeating_shipweapon">
				<label class="bold">Weapon Name<input type="text" name="attr_weapon_name"></label>
				<span>Scale:<input type="text" name="attr_weapon_scale" value="" class="smallnumber"></span>
				<span>Fire Arc:<input type="text" name="attr_weapon_arc" value="" ></span>
				<span>Crew:<input type="text" name="attr_weapon_crew" value="" ></span>
				<br>
				<span>Skill:<input type="text" name="attr_weapon_skill" value=""></span>
				<span>Fire Control:<input type="number" name="attr_weapon_fire_control" value="" class="smallnumber"> D</span>
				<br>
				<span>Space Range:<input type="number" name="attr_weapon_range_space" value="" class="mediumnumber"></span>
				<span>Atmosphere Range:<input type="number" name="attr_weapon_range_atmosphere" value="" class="smallnumber"></span>
				<br>
				<span>Damage:<input type="number" name="attr_weapon_damage" value="3" class="smallnumber">D+<input type="number" name="attr_weapon_damage_pip" value="0" class="smallnumber"> <button type="roll" name="roll_ship_wpn_dmg" value="&{template:default} {{name=@{weapon_name} damage}} {{Roll=[[(@{weapon_damage}- 1)d6cf0cs0 + @{weapon_damage_pip} +(1d6@{wilddie})]]}}">DMG</button></span>				
			</fieldset>
		</div>

<!-- -----------------------------------------------Generic Ship&Vehicle section -------------------------------- -->

		<div class="section ship"> 
			<div class='2colrow'>
				<div class='col'><!-- Vehicle -->
						<label style="padding-top:4px;padding-bottom:4px;" >Vehicle</label>
						<input class="skilltext" type="text"  style="width:95%;padding-bottom:8px;" name="attr_vehiclename"/>
						<textarea name="attr_vehicle" style="width:97%;height:17em;"></textarea>
				</div>
				<div class='col'><!-- Starship -->
						<label style="padding-top:4px;padding-bottom:4px;" >Starship</label>
						<input class="skilltext" type="text"  style="width:95%;padding-bottom:8px;" name="attr_starshipname"/>
						<textarea name="attr_starship" style="width:97%;height:17em;"></textarea>
				</div>
			</div>
		</div>

<!-- ----------- footer -------------------- -->

	<div class="section" style="text-align: Center; padding-top:10px;"> 
			<p class="version" style="text-align: center;"><small>Original Author: Timothy O'Driscoll | Main Editor: Andreas J. (Roll20user: 1223200) | </small></p>
	</div>
	</div>
</div>


<!-- -------------------------------Hidden Values----------------@{WoundLevel} +@{Pain}------------------------------->
<input type="hidden" name="attr_Force_EmptinessMod" value="0">
<input type="hidden" name="attr_WoundMod" value="0">


<!----------------------------------------------------- ROLL TEMPLATES --------------------->

<rolltemplate class="sheet-rolltemplate-blue">
<table>
    <caption>{{name}}</caption>
    {{#allprops() }}
       <tr><td>{{key}}</td><td>{{value}}</td>
    {{/allprops() }}
</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-green">
<table>
    <caption>{{name}}</caption>
    {{#allprops() }}
       <tr><td>{{key}}</td><td>{{value}}</td>
    {{/allprops() }}
</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-red">
<table>
    <caption>{{name}}</caption>
    {{#allprops() }}
       <tr><td>{{key}}</td><td>{{value}}</td>
    {{/allprops() }}
</table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-black">
<table>
    <caption>{{name}}</caption>
    {{#allprops() }}
       <tr><td>{{key}}</td><td>{{value}}</td>
    {{/allprops() }}
</table>
</rolltemplate>


<!-- ----------------------------------------------------- Sheet workers -------------------------------------- -->

<script type="text/worker">
/* ===== PARAMETERS ==========
destination = the name of the attribute that stores the total quantity
section = name of repeating fieldset, without the repeating_
fields = the name of the attribute field to be summed
      can be a single attribute: 'weight'
      or an array of attributes: ['weight','number','equipped']
multiplier (optional) = a multiplier to to entire fieldset total. For instance, if summing coins of weight 0.02, might want to multiply the final total by 0.02.
*/
const repeatingSum = (destination, section, fields, multiplier = 1) => {
    if (!Array.isArray(fields)) fields = [fields];
    getSectionIDs(`repeating_${section}`, idArray => {
        const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
        getAttrs(attrArray, v => {
            console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                 // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
            const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0); 
            const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
            setAttrs({[destination]: sumTotal * multiplier});    
        });
    });
};


on("change:painresist change:woundlevel", function() {
   getAttrs(["WoundLevel", "PainResist","WoundMod"], function(values) {
	if(values.WoundLevel == "0"){
		var update = {};
		update.WoundMod = "0";
		setAttrs(update);
	}
	else if(values.WoundLevel == "1"){
		var update = {};
		update.WoundMod = "1";
		setAttrs(update);
	}
	else if(values.WoundLevel == "2"){
		if(values.PainResist == "false"){
			var update = {};
			update.WoundMod = "2";
			setAttrs(update);
		}
		if(values.PainResist == "true"){
			var update = {};
			update.WoundMod = "1";
			setAttrs(update);
		}
	}
	else if(values.WoundLevel == "5"){
		if(values.PainResist == "true"){
			var update = {};
			update.WoundMod = "1";
			setAttrs(update);
		}
		if(values.PainResist == "false"){
			var update = {};
			update.WoundMod = "5";
			setAttrs(update);
		}
	}
   });
});

on("change:force_emptiness change:darksidepoints", function() {
   getAttrs(["Force_Emptiness","darkSidePoints"], function(values) {
		let v_Force_Emptiness = values.Force_Emptiness;
		let v_Force_EmptinessMod = 0;
		let v_darkSidePoints = parseInt(values.darkSidePoints)||0;

		if(v_Force_Emptiness == "true"){
			v_Force_EmptinessMod = 6 - v_darkSidePoints;
		}
		setAttrs({
			Force_EmptinessMod:v_Force_EmptinessMod
		});
   });
});

on("change:repeating_credittable remove:repeating_credittable", function() {
	repeatingSum("credit_spent","credittable","credit_amount");
});

on("change:repeating_cptable change:repeating_cptable", function() {
	repeatingSum("cp_spent", "cptable","cp_amount");
});
</script>
