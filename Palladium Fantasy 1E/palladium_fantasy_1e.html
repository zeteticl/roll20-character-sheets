<div class='sheet-base'>
    <div class="sheet-buttonbar">
        <div class="sheet-navbuttons">
            <button type="action" name="act_characterprofile1" class="sheet-topbuttons">Statistics</button>
            <button type="action" name="act_socialtab2" class="sheet-topbuttons sheet-socialT">Social</button>
            <button type="action" name="act_skilltab3" class="sheet-topbuttons">Skills</button>
            <button type="action" name="act_combattab4" class="sheet-topbuttons">Combat</button>
            <button type="action" name="act_equipmenttab5" class="sheet-topbuttons">Equipment</button>
            <button type="action" name="act_journaltab6" class="sheet-topbuttons">Journal</button>
        </div>
        <div class="line-divider">
            
        </div>
        <div class="sheet-docbuttons">
            <input type="hidden" name="attr_newcontent" value="read" class="sheet-newcontent" />
            <button type="action" name="act_releasetab7" class="sheet-topbuttons sheet-releasenotesbutton">Release Notes</button>
        </div>
    </div>
    <input type='radio' class='sheet-characterT' name='attr_sheetTab' style="display: none;" value='1' checked />
    <input type='radio' class='sheet-socialT' name='attr_sheetTab' style="display: none;" value='2' />
    <input type="radio" class="sheet-skillT" name="attr_sheetTab" style="display: none;" value="3" />
    <input type='radio' class='sheet-combatT' name='attr_sheetTab' style="display: none;" value='4' />
    <input type="radio" class="sheet-equipmentT" name="attr_sheetTab" style="display: none;" value="5" />
    <input type="radio" class="sheet-journalT" name="attr_sheetTab" style="display: none;" value="6" />
    <input type='radio' class='sheet-releaseN' name='attr_sheetTab' style="display: none;" value='7' />
    <!--Statistics Tab-->
    <div class='sheet-character'>
        <div class='statheader-container'>
            <h1>Statistics</h1>
            <h4>Macro Rolls:</h4>
            <div class="whispertoggle-container">
                <input type="radio" class="toggle-left" name="attr_whispertoggle" title="Public" value="" checked="checked"><span title="Public"></span>
                <input type="radio" class="toggle-right" name="attr_whispertoggle" title="GM Whisper" value="/w gm "><span title="Whisper"></span>
            </div>
        </div>
        <div class='name-grid-container'>
            <h4 class='name-label' title='Character Name' >Name</h4>
            <input class='name-stats' type='text' title='@{character_name}' value='' name='attr_character_name'/>
            <h4 class='name-label' title='Character True Name' >True Name</h4>
            <input class='name-stats' type='text' title='@{truename_name}' value='' name='attr_truename_name'/>
        </div>
        <div class='class-grid-container'>
            <h4 class='class-label'title='Occupational Character Class' >O.C.C.</h4>
            <input class='occ-stats' type='text' title='@{occ}' value='' name='attr_occ'/>
            <h4 class='class-label' title='Character Level' >Level</h4>
            <input class='class-stats' type='text' title='@{level}' value='' name='attr_level'/>
            <h4 class='class-label' title='Experience Points' >Experience</h4>
            <input class='exp-stats' type='text' title='@{experience}' value='' name='attr_experience'/>
        </div>
        <div class='middle-grid-container'>
            <div class='blue-grid-container'>
                <h4 class='stat-title'>Stat</h4>
                <h4 class='stat-title'>Now/Past</h4>
                <button class='statdice' type="roll" title='Intelligence Quotient' name='roll_iq_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=I.Q. Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{iq}}}" >I.Q.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{iq}' value='' name="attr_iq"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{iq_max}' value='' name="attr_iq_max"/>
                </div>
                <button class='statdice' type="roll" title='Mental Endurance' name='roll_me_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Mental Endurance Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{me}}}" >M.E.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{me}' value='' name="attr_me"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{me_max}' value='' name="attr_me_max"/>
                </div>
                <button class='statdice' type="roll" title='Mental Affinity' name='roll_ma_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Mental Affinity Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{ma}}}" >M.A.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{ma}' value='' name="attr_ma"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{ma_max}' value='' name="attr_ma_max"/>
                </div>
                <button class='statdice' type="roll" title='Physical Strength' name='roll_ps_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Physical Strength Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{ps}}}" >P.S.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{ps}' value='' name="attr_ps"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{ps_max}' value='' name="attr_ps_max"/>
                </div>
                <button class='statdice' type="roll" title='Physical Prowess' name='roll_pp_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Physical Prowess Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{pp}}}" >P.P.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{pp}' value='' name="attr_pp"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{pp_max}' value='' name="attr_pp_max"/>
                </div>
                <button class='statdice' type="roll" title='Physical Endurance' name='roll_pe_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Physical Endurance Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{pe}}}" >P.E.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{pe}' value='' name="attr_pe"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{pe_max}' value='' name="attr_pe_max"/>
                </div>
                <button class='statdice' type="roll" title='Physical Beauty' name='roll_pb_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Physical Beauty Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{pb}}}" >P.B.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{pb}' value='' name="attr_pb"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{pb_max}' value='' name="attr_pb_max"/>
                </div>
                <button class='statdice' type="roll" title='Speed' name='roll_spd_check' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Speed Check}} {{Check=[[1d20cs<1cf>20]]|[[1d100cs<1cf>100]]}} {{Target=@{spd}}}" >Spd.</button>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{spd}' value='' name="attr_spd"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{spd_max}' value='' name="attr_spd_max"/>
                </div>
            </div>
            <div class='mid-column-gap'></div>
            <div class='gold-grid-container'>
                <h4 class='calc-title'>Autocalc</h4>
                <h4 class='calc-title'>Stats</h4>
                <h4 class='calc-label' title='Maximum Lift' >Lift lbs.</h4>
                <input class='calc-field' type="text" value="" name="attr_lift" readonly>
                <h4 class='calc-label' title='Maximum Carrying Weight' >Carry lbs.</h4>
                <input class='calc-field' type="text" value="" name="attr_carry" readonly>
                <h4 class='calc-label' title='Time Between Rests at Max Carry Weight' >Carry Max</h4>
                <input class='calc-field' type="text" value="" name="attr_carry_max" readonly>
                <h4 class='calc-label' title='Rounded Run Speed in Miles per Hour' >Run MPH</h4>
                <input class='calc-field' type="text" value="" name="attr_run_mph" readonly>
                <h4 class='calc-label' title='Maximum Feet of Movement per Melee' >Run/Melee</h4>
                <input class='calc-field' type="text" value="" name="attr_run_melee" readonly>
                <h4 class='calc-label' title='Maximum Feet of Movement per Action' >Run/Action</h4>
                <input class='calc-field' type="text" value="" name="attr_run_attack" readonly>
                <h4 class='calc-label' title='Time Beween Rests When Running' >Run Minutes</h4>
                <input class='calc-field' type="text" value="" name="attr_run_max" readonly>
                <div class='spaceholder'></div>
                <div class='spaceholder'></div>
            </div>
            <div class='mid-column-gap'></div>
            <div class='ltblue-grid-container'>
                <h4 class='roll-title'>Resources &</h4>
                <h4 class='roll-title'>Rolls</h4>
                <h4 class='roll-label' title='Hit Points' >Hit Points</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{character_hp}' value='' name="attr_character_hp"/>
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{character_hp_max}' value='' name="attr_character_hp_max"/>
                </div>
                <h4 class='roll-label' title='Armor Rating' >Armor Rating</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{character_ar}' value='' name="attr_character_ar"/>
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{character_ar_max}' value='' name="attr_character_ar_max"/>
                </div>
                <h4 class='roll-label' title='Armor Structural Damage Capacity' >Armor S.D.C.</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{character_sdc}' value='' name="attr_character_sdc"/>
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{character_sdc_max}' value='' name="attr_character_sdc_max"/>
                </div>
                <button class='rolldice' type="roll" title='Trust or Intimidate' name='roll_invoke_trust' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Trust or Intimidate Attempt}} {{Skill Check=[[1d100]]}} {{Chance of Success=@{invoke_trust}}}" >Trust</button>
                <input class='roll-field' type="text" value="0" name="attr_invoke_trust" readonly>
                <button class='rolldice' type="roll" title='Charm or Impress' name='roll_charm_impress' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Charm or Impress Attempt}} {{Skill Check=[[1d100]]}} {{Chance of Success=@{charm_impress}}}" >Charm</button>                
                <input class='roll-field' type="text" value="0" name="attr_charm_impress" readonly>
                <button class='rolldice' type="roll" title='Perception based on IQ and ME' name='roll_perception' value="@{whispertoggle}&{template:custom} {{color=yellow}} {{title=**@{character_name}**}} {{subtitle=Perception}} {{Perception=[[d20cs<1cf>20+@{perception}]]}} {{desc=Target equal or below=[[floor((@{iq}+@{me})/2)]]}}" >Percep.</button>                
                <input class='roll-field' type='text' title='Perception Bonus' value="0" name="attr_perception" />
                <button class='rolldice' type="roll" title='Initiative (d20+80)' name='roll_initiative' value="@{whispertoggle}&{template:custom} {{color=black}} {{title=**@{character_name}**}} {{subtitle=Initiative}} {{Initiative=[[d20+80+@{initiative_mod}&{tracker}]]}}" >Init.</button>                
                <input class='roll-field' type='text' title='Initiative Bonus' value="0" name="attr_initiative_mod" />
                <button class='rolldice' type="roll" title='Dodge' name='roll_dodge' value="@{whispertoggle}&{template:custom} {{color=grey}} {{title=**@{character_name}**}} {{subtitle=Attempts to Dodge}} {{Dodge=[[1d20+@{hth_dodge}+@{pp_bonus}+@{temp_dodge}@{mountedpd}]]}} {{desc=Dodge takes the place of a remaining attack this round.}}" >Dodge</button>                
                <input class='roll-field' type='text' title='Dodge Bonus Other Than HtH or PP' value="0" name="attr_temp_dodge"/>
            </div>
            <div class='mid-column-gap'></div>
            <div class='caster-grid-container'>
                <h4 class='caster-title'>Caster</h4>
                <h4 class='caster-title'>Stats</h4>
                <h4 class='caster-label' title='Psionic Level' >Psionic Lvl</h4>
                <input class='caster-field' type='text' title='@{psi_level}' value="0" name="attr_psi_level"/>
                <h4 class='caster-label' title='Psionic Inner Strength Points' >Psion I.S.P.</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{character_pisp}' value='' name="attr_character_pisp"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{character_pisp_max}' value='' name="attr_character_pisp_max"/>
                </div>
                <h4 class='caster-label' title='Healer Inner Strength Points' >Healer I.S.P.</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{character_hisp}' value='' name="attr_character_hisp"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{character_hisp_max}' value='' name="attr_character_hisp_max"/>
                </div>
                <h4 class='caster-label' title='Magic Caster Level' >Caster Lvl</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{caster_level}' value="0" name="attr_caster_level" />
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{caster_level_max}' value="0" name="attr_caster_level_max" />
                </div>
                <h4 class='caster-label' title='Daily Spell Casts' >Daily Casts</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type=text title='@{character_casts}' value='' name="attr_character_casts"/>
                    <div class='divider'></div>
                    <input class='minmax' type=text title='@{character_casts_max}' value='' name="attr_character_casts_max"/>
                </div>
                <h4 class='caster-label' title='Spell Strength' >Spell Str.</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{spell_strength}' value="0" name="attr_spell_strength" />
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{spell_strength_max}' value="0" name="attr_spell_strength_max" />
                </div>
                <h4 class='caster-label' title='Ward Level' >Ward Lvl</h4>
                <input class='caster-field' type='text' title='@{ward_level}' value="0" name="attr_ward_level" />
                <h4 class='caster-label' title='Daily Ward Activations' >Daily Wards</h4>
                <div class='fraction-grid-container'>
                    <input class='minmax' type='text' title='@{ward_casts}' value="" name="attr_ward_casts" />
                    <div class='divider'></div>
                    <input class='minmax' type='text' title='@{ward_casts_max}' value="" name="attr_ward_casts_max" />
                </div>
                <h4 class='caster-label' title='Ward Strength' >Ward Str.</h4>
                <input class='caster-field' type='text' title=@{ward_strength} value="0" name="attr_ward_strength" />
                <h4 class='caster-label' title='Circle Level' >Circle Lvl</h4>
                <input class='caster-field' type='text' title='@{circle_level}' value="0" name="attr_circle_level" />
                <h4 class='caster-label' title='Circle Strength' >Circle Str.</h4>
                <input class='caster-field' type='text' title='@{circle_strength}' value="0" name="attr_circle_strength" />
            </div>
        </div>
        <div class='movement-container'>
            <div class="movement-panel">
                <input type="checkbox" name="attr_addl_movement_toggle" class="sheet-arrow" />
                <h4>Additional Movement</h4>
                <div class="body">
                    <div class="leap-panel">
                        <div class='leap-grid-container' >
                            <div class='space-holder'></div>
                            <h5>Verticle</h5>
                            <h5>Horizontal</h5>
                            <div class='space-holder'></div>
                            <h4>Leaping Distance</h4>
                            <input class='leaping-field' type="number" name="attr_leapup" value="3" />
                            <input class='leaping-field' type="number" name="attr_leapout" value="4" />
                            <h4>Feet</h4>
                        </div>
                    </div>
                    <div class='movement-grid-container' >
                        <h5>Movement Type</h5>
                        <h5>Speed</h5>
                        <h5>MPH</h5>
                        <h5>Run/Melee</h5>
                        <h5>Run/Action</h5>
                        <h5>Max Run</h5>
                        <div class='space-holder'></div>
                    </div>
                    <fieldset class="repeating_movement">
                        <div class='movement-grid-container' >
                            <input class='movement-field' type="text" value="" name="attr_movement_name" placeholder="Additional Movement Type" />
                            <input class='movement-field' type="number" value="" name="attr_movement_spd" />
                            <input class='movement-field' type="number" value="" name="attr_movement_mph" />
                            <input class='movement-field' type="number" value="" name="attr_movement_ft_melee" />
                            <input class='movement-field' type="number" value="" name="attr_movement_ft_attack" />
                            <input class='movement-field' type="number" value="" name="attr_movement_at_max" />
                            <h4>minutes</h4>
                        </div>
                    </fieldset>
                </div>    
            </div>
        </div>
        <div class="melee-attack-panel">
            <input type="checkbox" name="attr_melee_attacks-toggle" class="sheet-arrow" />
            <h4>Melee Attacks</h4>
            <div class="body">
                <div class="attackoptions-container">
                    <h4>Melee Options:</h4>
                    <h5>Parry/Dodge:</h5>
                    <div class="mountparry-container">
                        <input type="radio" class="ctoggle-left" name="attr_mountedpd" title="No extra bonuses" value="" checked="checked"><span title="On Foot"></span>
                        <input type="radio" class="ctoggle-right" name="attr_mountedpd" title="Adds mounted parry/dodge to parry and dodge rolls" value="+@{hth_mountedparrydodge}"><span title="Mounted"></span>
                    </div>
                    <h5>Damage:</h5>
                    <div class="mountdamage-container">
                        <input type="radio" class="ctoggle-left" name="attr_mounteddam" title="No extra bonuses" value="" checked="checked"><span title="On Foot"></span>
                        <input type="radio" class="ctoggle-middle" name="attr_mounteddam" title="Adds mounted damage to melee damage rolls" value="+@{hth_mounteddamage}"><span title="Mounted"></span>
                        <input type="radio" class="ctoggle-right" name="attr_mounteddam" title="Adds mounted charge damage to melee damage rolls" value="+@{hth_chargedamage}"><span title="Charge"></span>
                    </div>                    
                </div>
                <div class='meleetemp-container'>
                    <h4>Temporary Bonuses:</h4>
                    <h5>Strike:</h5>
                    <input class='mattack-text' type="text" title='Temporary Melee Strike Bonuses' value="0" name="attr_mtemp_strike" />
                    <h5>Parry:</h5>
                    <input class='mattack-text' type="text" title='Temporary Melee Parry Bonuses' value="0" name="attr_mtemp_parry" />
                    <h5>Damage:</h5>
                    <input class='mattack-text' type="text" title='Temporary Melee Damage Bonuses' value="0" name="attr_mtemp_damage" />
                </div>
                <div class='mattack-grid-container'>
                    <h5>Weapon Name</h5>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <h5>Damage</h5>
                    <div class='space-holder'></div>
                </div>
                <fieldset class="repeating_meleeattacks">
                    <div class='mattack-grid-container' > 
                        <input class='mattack-label' type="text" value="" title='Weapon name that will display in template header' name="attr_weapon_attack" placeholder="Weapon Name" />
                        <button class='meleedice' type='roll' title='Strike (Attack) Roll with Damage' name='roll_meleeattack' value="@{whispertoggle}&{template:custom} {{color=blue}} {{title=**@{character_name}**}} {{subtitle=attacks with @{weapon_attack}}} {{Attack= [[d20cs>@{hth_critical}+@{weapon_strike}+@{hth_strike}+@{pp_bonus}+@{mtemp_strike}]]}} {{Damage= [[@{weapon_damage}+@{hth_damage}+@{ps_bonus}+@{mtemp_damage}@{mounteddam}]]}} {{desc=@{mattack_reference}}}">Strike</button>
                        <button class='meleedice' type='roll' title='Parry Roll' name='roll_meleeparry' value="@{whispertoggle}&{template:custom} {{color=grey}} {{title=**@{character_name}**}} {{subtitle=parries with @{weapon_attack}}} {{Parry= [[d20+@{weapon_parry}+@{hth_parry}+@{pp_bonus}+@{mtemp_parry}@{mountedpd}]]}}">Parry</button>
                        <button class='meleedice' type='roll' title='Damage Roll' name='roll_meleedamage' value="@{whispertoggle}&{template:custom} {{color=red}} {{title=**@{character_name}**}} {{subtitle=lashes out}} {{@{character_name}'s @{weapon_attack} deals= [[@{weapon_damage}+@{hth_damage}+@{ps_bonus}+@{mtemp_damage}@{mounteddam}]]}} {{desc=@{mattack_reference}}}">Damage</button>
                        <input class='damage-dice' type="text" title='Damage Dice Calculation other than HtH and PS' value="" name="attr_weapon_damage" placeholder="xdy+z" />
                        <input type='checkbox' title='Show Bonus and Notes Fields' name='attr_toggle_mbonus' value="1">
                        <input class='mbonus-toggle' type='hidden' name='attr_toggle_mbonus'>
                        <div class='mbonus-hide'>
                            <div class='mbonus-container'>
                                <input class='mattack-bonus' type='text' value='' title='Strike Bonuses other than HtH or PP' value="0" name="attr_weapon_strike" />
                                <input class='mattack-bonus' type="text" title='Parry Bonuses other than HtH or PP' value="0" name="attr_weapon_parry" />
                                <textarea class='mattack-notes' type="text" title='Special Note About This Attack' value="" name="attr_mattack_reference" ></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="ranged-attack-panel">
            <input type="checkbox" name="attr_ranged_attacks-toggle" class="sheet-arrow" />
            <h4>Ranged or Magical Attacks</h4>
            <div class="body">
                <div class='rangedtemp-container'>
                    <h4>Temporary Bonuses:</h4>
                    <h5>Strike:</h5>
                    <input class='rattack-text' type="text" title='Temporary Ranged Strike Bonuses' value="0" name="attr_rtemp_strike" />
                    <h5>Damage:</h5>
                    <input class='rattack-text' type="text" title='Temporary Ranged Damage Bonuses' value="0" name="attr_rtemp_damage" />
                </div>
                <div class='rattack-grid-container' >
                    <h5>Weapon Name</h5>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <h5>Damage</h5>
                    <h5>Range</h5>
                    <h5>RoF</h5>
                    <h5>Ammo</h5>
                    <div class='space-holder'></div>
                </div>
                <fieldset class="repeating_rangedattacks"> 
                    <div class='rattack-grid-container' >
                        <input class='rattack-label' type="text" title='Weapon name that will display in template header' value="" name="attr_weapon_attack" placeholder="Weapon Name" />
                        <button class='rangeddice' type='roll' title='Strike (Attack) Roll with Damage' name='roll_rangedattack' value="@{whispertoggle}&{template:custom} {{color=blue}} {{title=**@{character_name}**}} {{subtitle=attacks with @{weapon_attack}}} {{Attack= [[d20cs>@{hth_ranged_critical}+@{weapon_strike}+@{rtemp_strike}]]}} {{Damage= [[@{weapon_damage}+@{rtemp_damage}]]}} {{desc=@{attack_reference}}}">Strike</button>
                        <button class='rangeddice' type='roll' title='Damage Roll Alone' name='roll_rangeddamage' value="@{whispertoggle}&{template:custom} {{color=red}} {{title=**@{character_name}**}} {{subtitle=hits with @{weapon_attack}}} {{@{character_name}'s @{weapon_attack} deals= [[@{weapon_damage}+@{rtemp_damage}]]}} {{desc=@{attack_reference}}}">Damage</button>
                        <input class='damage-dice' type="text" title='Damage Dice Calculation' value="" name="attr_weapon_damage" placeholder="xdy+z" />
                        <input class='rattack-text' type="text" title='Maximum Range of This Attack' value="" name="attr_weapon_range" />
                        <input class='rattack-text' type="text" title='Rate of Fire per Melee' value="1" name="attr_weapon_rate_of_fire" />
                        <input class='rattack-text' type='text' title='Ammunition' value='0' name='attr_ammunition' />
                        <input type='checkbox' title='Show Bonus and Notes Fields' name='attr_toggle_rbonus' value="1">
                        <input class='rbonus-toggle' type='hidden' name='attr_toggle_rbonus'>
                        <div class='rbonus-hide'>
                            <div class='rbonus-container'>
                                <input class='rattack-bonus' type="text" title='Bonuses to Strike' value="0" name="attr_weapon_strike" />
                                <textarea class='rattack-notes' title='Special Note About This Attack' value="" name="attr_attack_reference" ></textarea>
                            </div>
                        </div>    
                    </div>
                </fieldset>
            </div>
        </div> 
    </div>
    <!--Social Tab-->
    <div class='sheet-social'>
        <h1>Social Information</h1>
        <div class='physical-grid-container'>
            <h4 class='physical-label'>Race</h4>
            <h4 class='physical-label'>Age</h4>
            <h4 class='physical-label'>Gender</h4>
            <h4 class='physical-label'>Height</h4>
            <h4 class='physical-label'>Weight</h4>
            <input class='physical-field' type="text" value="" name="attr_character_race"/>
            <input class='physical-field' type="text" value="" name="attr_character_age" />
            <input class='physical-field' type="text" value="" name="attr_character_gender" />
            <input class='physical-field' type="text" value="" name="attr_character_height" />
            <input class='physical-field' type="text" value="" name="attr_character_weight" />
        </div>
        <div class='origin-grid-container'>
            <h4 class='origin-label'>Alignment</h4>
            <h4 class='origin-label'>Land of Origin</h4>
            <h4 class='origin-label'>Native Language</h4>
            <input class='physical-field' type="text" value='' name="attr_alignment" />
            <input class='origin-field' type="text" value="" name="attr_character_landorigin" />
            <input class='origin-field' type="text" value="" name="attr_character_languages" />
        </div>
        <div class='mental-grid-container'>
            <h4 class='mental-label'>Family Origin</h4>
            <textarea class='mental-field' value="" name="attr_character_familyorigin" placeholder='Family occupation, syblings, etc.' /></textarea>
            <h4 class='mental-label'>Natural Abilities</h4>
            <textarea class='mental-field' value="" name="attr_character_natural" placeholder='Racial, or story special abilities your character may have' /></textarea>
            <h4 class='mental-label'>Disposition</h4>
            <textarea class='mental-field' value="" name="attr_character_disposition" placeholder='Personality quirks and life outlook beyond alignment' /></textarea>
            <h4 class='mental-label'>Hostilities</h4>
            <textarea class='mental-field' value="" name="attr_character_hostility" placeholder='Hostilities, pet peeves, likes and dislikes' /></textarea>
            <h4 class='mental-label'>Insanity</h4>
            <textarea class='mental-field' value="" name="attr_character_insanity" placeholder='Hope this placeholder never gets replaced...' /></textarea>
            <h4 class='mental-label'>O.C.C. Notes</h4>
            <textarea class='mental-field' value="" name="attr_character_classnotes" placeholder='Anything about your class that needs kept in mind' /></textarea>
        </div> 
    </div>
    <!--Skills Tab-->
    <div class='sheet-skill'>
        <h1>Skills</h1>
        <div class='universalrow-grid-container'>
            <button type="roll" name='roll_skill' value="@{whispertoggle}&{template:custom} {{color=green}} {{title=**@{character_name}}} {{subtitle=?{What Skill?|No Reason}}} {{Check=[[1d100]]-@{iq_bonus}}}" ></button> 
            <h5>Universal Skill Roll</h5>
            <input class='bonus-field' type="text" value="" name="attr_iq_bonus" readonly>
            <h5>I.Q. Skill Bonus</h5>
        </div>    
        <div class="occ-skill-panel">
            <input type="checkbox" name="attr_OCC-Skill-toggle" class="sheet-arrow" />
            <h4>Occupational Class Skills</h4>
            <div class="body">
                <div class='skill-grid-container' >
                    <div class='space-holder'></div>
                    <h5>Skill Name</h5>
                    <h5>Rating</h5>
                    <div class='percent-space'></div>
                    <h5>Skill Lvl</h5>
                    <h5>Notes</h5>
                </div>
                <fieldset class="repeating_skillocc">
                    <div class='skill-grid-container' >
                        <button type="roll" name='roll_occskill' value="@{whispertoggle}&{template:custom} {{color=green}} {{title=**@{character_name}'s**}} {{subtitle=@{skill_name}}} {{Check=[[d100cs<1cf>100-@{iq_bonus}]]}} {{Skill=@{skill_rating}}} {{desc=@{skill_reference}}}"></button>
                        <input class='occ-field' type="text" value="" name="attr_skill_name" placeholder="Skill name"/>
                        <input class='occ-field' type="number" title='Total Skill Percentage Rating' value="" name="attr_skill_rating" />
                        <h6>%</h6>
                        <input class='occ-field' type="number" title='Skill Level' value="1" name="attr_skill_level" />
                        <input class="skill-notes" type="text" value="" name="attr_skill_reference" />
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="elective-skill-panel">
            <input type="checkbox" name="attr_Elective-Skill-toggle" class="sheet-arrow" />
            <h4>Elective Skills</h4>
            <div class="body">
                <div class='skill-grid-container' >
                    <div class='space-holder'></div>
                    <h5>Name</h5>
                    <h5>Rating</h5>
                    <div class='percent-space'></div>
                    <h5>Skill Lvl</h5>
                    <h5>Notes</h5>
                </div>
                <fieldset class="repeating_skillelective">
                    <div class='skill-grid-container' >
                        <button type="roll" name='roll_electiveskill' value="@{whispertoggle}&{template:custom} {{color=green}} {{title=**@{character_name}'s**}} {{subtitle=@{skill_name}}} {{Check=[[d100cs<1cf>100-@{iq_bonus}]]}} {{Skill=@{skill_rating}}} {{desc=@{skill_reference}}}"></button>
                        <input class='elective-field' type="text" value="" name="attr_skill_name" placeholder="Skill name"/>
                        <input class='elective-field' type="number" title='Total Skill Percentage Rating' value="" name="attr_skill_rating" />
                        <h6>%</h6>
                        <input class='elective-field' type="number" title='Skill Level' value="1" name="attr_skill_level" />
                        <input class="skill-notes" type="text" value="" name="attr_skill_reference" />
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="secondary-skill-panel">
            <input type="checkbox" name="attr_Secondary-Skill-toggle" class="sheet-arrow" />
            <h4>Secondary Skills</h4>
            <div class="body">
                <div class='skill-grid-container' >
                    <div class='space-holder'></div>
                    <h5>Name</h5>
                    <h5>Rating</h5>
                    <div class='percent-space'></div>
                    <h5>Skill Lvl</h5>
                    <h5>Notes</h5>
                </div>
                <fieldset class="repeating_skillsecondary">
                    <div class='skill-grid-container' >
                        <button type="roll" name='roll_secondaryskill' value="@{whispertoggle}&{template:custom} {{color=green}} {{title=**@{character_name}'s**}} {{subtitle=@{skill_name}}} {{Check=[[d100cs<1cf>100-@{iq_bonus}]]}} {{Skill=@{skill_rating}}} {{desc=@{skill_reference}}}"></button>
                        <input class='secondary-field' type="text" value="" name="attr_skill_name" placeholder="Skill name"/>
                        <input class='secondary-field' type="number" title='Total Skill Percentage Rating' value="" name="attr_skill_rating" />
                        <h6>%</h6>
                        <input class='secondary-field' type="number" title='Skill Level' value="1" name="attr_skill_level" />
                        <input class="skill-notes" type="text" value="" name="attr_skill_reference" />
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="mystic-skill-panel">
            <input type="checkbox" name="attr_Mystic-Skill-toggle" class="sheet-arrow" />
            <h4>Mystic Skills</h4>
            <div class="body">
                <div class='skill-grid-container' >
                    <div class='space-holder'></div>
                    <h5>Name</h5>
                    <h5>Rating</h5>
                    <div class='percent-space'></div>
                    <h5>Skill Lvl</h5>
                    <h5>Notes</h5>
                </div>
                <fieldset class="repeating_skillmystic">
                    <div class='skill-grid-container' >
                        <button type="roll" name='roll_mysticskill' value="@{whispertoggle}&{template:custom} {{color=green}} {{title=**@{character_name}'s**}} {{subtitle=@{skill_name}}} {{Check=[[d100cs<1cf>100]]}} {{Skill=@{skill_rating}}} {{desc=@{skill_reference}}}"></button>
                        <input class='mystic-field' type="text" value="" name="attr_skill_name" placeholder="Skill name"/>
                        <input class='mystic-field' type="number" title='Total Skill Percentage Rating' value="" name="attr_skill_rating" />
                        <h6>%</h6>
                        <input class='mystic-field' type="number" title='Skill Level' value="1" name="attr_skill_level" />
                        <input class="skill-notes" type="text" value="" name="attr_skill_reference" />
                    </div>
                </fieldset>
            </div>
        </div> 
    </div>
    <!--Combat Tab-->
    <div class='sheet-combat'>
        <h1>Combat</h1>
        <div class="melee-proficiency-panel">
            <input type="checkbox" name="attr_melee_weapon-toggle" class="sheet-arrow" />
            <h4>Melee Weapon Proficencies</h4>
            <div class="body">
                <div class='melee-grid-container' >
                    <h5>Weapon</h5>
                    <h5>Skill Lvl</h5>
                    <h5>Strike</h5>
                    <h5>Parry</h5>
                    <h5>Throw</h5>
                    <h5>Range</h5>
                </div>
                <fieldset class="repeating_weaponmelee">
                    <div class='melee-grid-container' >
                        <input class='melee-field' type="text" value="" name="attr_melee_weapon_name" placeholder="Weapon Type" />
                        <input class='melee-field' type="number" title='Proficiency Skill Level' value="1" name="attr_melee_weapon_skill_level" />
                        <input class='melee-field' type="number" title='Proficiency Strike Bonus' value="0" name="attr_melee_weapon_strike" />
                        <input class='melee-field' type="number" title='Proficiency Parry Bonus' value="0" name="attr_melee_weapon_parry" />
                        <input class='melee-field' type="number" title='Proficiency Throw Bonus' value="0" name="attr_melee_weapon_throw" />
                        <input class='melee-field' type="number" title='Proficiency Throw Range (if any)' value="0" name="attr_melee_weapon_range" />
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="ranged-proficiency-panel">
            <input type="checkbox" name="attr_ranged_weapon-toggle" class="sheet-arrow" />
            <h4>Ranged Weapon Proficencies</h4>
            <div class="body">
                <div class='ranged-grid-container'>
                    <h5>Weapon</h5>
                    <h5>Skill Lvl</h5>
                    <h5>Strike</h5>
                    <h5>RoF</h5>
                    <h5>Range</h5>
                </div>
                <fieldset class="repeating_rangedmelee">
                    <div class='ranged-grid-container' >
                        <input class='ranged-field' type="text" value="" name="attr_ranged_weapon_name" placeholder="Weapon Type" />
                        <input class='ranged-field' type="number" title='Proficiency Skill Level' value="1" name="attr_ranged_weapon_skill_level" />
                        <input class='ranged-field' type="number" title='Proficiency Strike Bonus' value="0" name="attr_ranged_weapon_strike" />
                        <input class='ranged-field' type="number" title='Proficiency Rate of Fire' value="0" name="attr_ranged_weapon_parry" />
                        <input class='ranged-field' type="number" title='Proficiency Max Firing Distance' value="0" name="attr_ranged_weapon_range" />
                    </div>
                </fieldset>
            </div>
        </div>    
        <div class="combat-skill-panel">
            <input type="checkbox" name="attr_combatskill-toggle" class="sheet-arrow" />
            <h4>Hand to Hand Combat Skill</h4>
            <div class="body">
                <div class='combat-grid-container' >
                    <input class='combat-field' type="text" class='combat-text' name="attr_combatskill_type" placeholder="Combat Type" />
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <textarea wrap="soft" class="combat-textarea" value="" name="attr_combatskill_notes" placeholder="Style Details like kick attack, disarms, racial bite or claw attacks, etc." /></textarea>
                </div>
                <div class='bonus-grid-container' >
                    <h5>Combat Skill Level</h5>
                    <input class='combat-field' type="number" title="@{hth_level}" name="attr_hth_level" value="0" />
                    <div class='space-holder'></div>
                    <h5>Number of Attacks</h5>
                    <input class='combat-field' type="number" title="@{hth_numberattacks}" name="attr_hth_numberattacks" value="1" />
                    <h5>Strike</h5>
                    <input class='combat-field' type="number" title="@{hth_strike}" name="attr_hth_strike" value="0" />
                    <div class='space-holder'></div>
                    <h5>Damage</h5>
                    <input class='combat-field' type="number" title="@{hth_damage}" name="attr_hth_damage" value="0" />
                    <h5>Parry</h5>
                    <input class='combat-field' type="number" title="@{hth_parry}" name="attr_hth_parry" value="0" />
                    <div class='space-holder'></div>
                    <h5>Dodge</h5>
                    <input class='combat-field' type="number" title="@{hth_dodge}" name="attr_hth_dodge" value="0" />
                    <h5>Mounted Damage</h5>
                    <input class='combat-field' type="number" title="@{hth_mounteddamage}" name="attr_hth_mounteddamage" value="0" />
                    <div class='space-holder'></div>
                    <h5>Charge Damage</h5>
                    <input class='combat-field' type="number" title="@{hth_chargedamage}" name="attr_hth_chargedamage" value="0" />                    
                    <h5>Mounted Parry/Dodge</h5>
                    <input class='combat-field' type="number" title="@{hth_mountedparrydodge}" name="attr_hth_mountedparrydodge" value="0" />
                    <div class='space-holder'></div>
                    <h5>Disarm</h5>
                    <input class='combat-field' type="number" title="@{hth_disarm}" name="attr_hth_disarm" value="0" />
                    <h5>Knockout/Stun</h5>
                    <input class='combat-field' type="number" title="@{hth_knockout}" name="attr_hth_knockout" value="none" />
                    <div class='space-holder'></div>
                    <h5>Critical Strike</h5>
                    <input class='combat-field' type="number" title="@{hth_critical}" name="attr_hth_critical" value="20" />
                    <h5>Ranged Critical Strike</h5>
                    <input class='combat-field' type="number" title="@{hth_ranged_critical}" name="attr_hth_ranged_critical" value="20" />
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <h5>Physical Prowess Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{pp_bonus}" name="attr_pp_bonus" readonly>
                    <div class='space-holder'></div>
                    <h5>Physical Strength Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{ps_bonus}" name="attr_ps_bonus" readonly>
                </div>
            </div>
        </div>
        <div class="saving-throw-panel">
            <input type="checkbox" name="attr_saves-toggle" class="sheet-arrow" />
            <h4>Saving Throws</h4>
            <div class="body">
                <div class='saves-grid-container' >
                    <h5 class='underline'>Magic Save Type</h5>
                    <h5 class='underline'>Target</h5>
                    <h5 class='underline'>Bonus</h5>
                    <div class='space-holder'></div>
                    <h5 class='underline'>Save Type</h5>
                    <h5 class='underline'>Target</h5>
                    <h5 class='underline'>Bonus</h5>
                    <button class='savedice' type="roll" name='roll_circlesave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Circles}} {{Save=[[d20+@{save_circle}+@{pe_magpois}]]}} {{Target= @{save_circle-target}}} {{desc=@{save_notes}}}" >Circles</button>
                    <input class='save-field' type="number" value="13" name="attr_save_circle-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_circle" />
                    <div class='space-holder'></div>
                    <button class='savedice' type="roll" name='roll_insanitysave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Insanity}} {{Save=[[d20+@{save_insane}+@{me_insanity}]]}} {{Target= @{save_insanity-target}}} {{desc=@{save_notes}}}" >Insanity</button>
                    <input class='save-field' type="number" value="12" name="attr_save_insanity-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_insane" />
                                       
                    
                    <button class='savedice' type="roll" name='roll_fumesave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Fumes}} {{Save=[[d20+@{save_fumes}+@{pe_magpois}]]}} {{Target= @{save_fumes-target}}} {{desc=@{save_notes}}}" >Fumes</button>
                    <input class='save-field' type="number" value="14" name="attr_save_fumes-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_fumes" />
                    <div class='space-holder'></div>
                    <button class='savedice' type="roll" name='roll_psionicsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Psionics}} {{Save=[[d20+@{save_psi}+@{me_psionic}]]}} {{Target= @{save_psi-target}}} {{desc=@{save_notes}}}" >Psionics</button>
                    <input class='save-field' type="number" value="15" name="attr_save_psi-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_psi" />
                    
                    
                    <button class='savedice' type="roll" name='roll_spellsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Spells}} {{Save=[[d20+@{save_spells}+@{pe_magpois}]]}} {{Target= @{save_spells-target}}} {{desc=@{save_notes}}}" >Spells</button>
                    <input class='save-field' type="number" value="12" name="attr_save_spells-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_spells" />
                    <div class='space-holder'></div>
                    <button class='savedice' type="roll" name='roll_soulsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Souldrinking}} {{Save=[[d20+@{save_souldrinking}+@{pe_magpois}]]}} {{Target= @{save_souldrink-target}}} {{desc=@{save_notes}}}" >Soul Drink</button>
                    <input class='save-field' type="number" value="14" name="attr_save_souldrink-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_souldrinking" />
                    
                    
                    <button class='savedice' type="roll" name='roll_wardsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Wards}} {{Save=[[d20+@{save_wards}+@{pe_magpois}]]}} {{Target= @{save_wards-target}}} {{desc=@{save_notes}}}" >Wards</button>
                    <input class='save-field' type="number" value="13" name="attr_save_wards-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_wards" />
                    <div class='space-holder'></div>
                    <button class='savedice' type="roll" name='roll_poisonsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}**}} {{subtitle=Save vs. Poison}} {{Save=[[d20+@{save_poison}+@{pe_magpois}]]}} {{Target= @{save_poison-target}}} {{desc=@{save_notes}}}" >Poison</button>
                    <input class='save-field' type="number" value="14" name="attr_save_poison-target" />
                    <input class='save-field' type="number" value="0" name="attr_save_poison" />
                    
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>                    
                    <button class='savedice' type="roll" name='roll_deathsave' value="@{whispertoggle}&{template:custom} {{color=brown}} {{title=**@{character_name}'s**}} {{subtitle=Save vs. Coma/Death}} {{Save 1=[[d100+@{save_comadeath}+@{pe_coma}]]}} {{Save 2=[[d100+@{save_comadeath}+@{pe_coma}]]}} {{Save 3=[[d100+@{save_comadeath}+@{pe_coma}]]}} {{desc=**Roll 3 times each hour and need 2 successes.** Target is 59 with normal treatment, or 31 with magical treatment.}}" >Coma/Death</button>
                    <div class='space-holder'></div>
                    <input class='save-field' type="number" value="0" name="attr_save_comadeath" />
                    
                    <h5>PE Save Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{pe_magpois}" name="attr_pe_magpois" readonly>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <h5>ME Psionic Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{me_psionic}" name="attr_me_psionic" readonly>
                    <div class='space-holder'></div>
                    
                    <h5>PE Coma/Death Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{pe_coma}" name="attr_pe_coma" readonly>
                    <div class='space-holder'></div>
                    <div class='space-holder'></div>
                    <h5>ME Insanity Bonus</h5>
                    <input class='bonus-field' type="text" value="" title="@{me_insanity}" name="attr_me_insanity" readonly>
                    <div class='space-holder'></div>
                    
                    <div class="save-notes-container" >
                        <textarea class='save-misc' value='' name='attr_save_notes' title='@{save_notes}' placeholder='Notes displayed with all saves except coma/death.' ></textarea>
                    </div> 
                </div>
            </div>
        </div> 
    </div>
    <!--Equipment Tab-->
    <div class="sheet-equipment">
        <h1>Equipment</h1>
        <div class='encumbrance-panel'>
            <h5>Total Weight</h5>
            <div class='space-holder' ></div>
            
            <input class='weight-box' type='text' value='0' title='Total Weight' name='attr_total_weight' readonly>
            <h5>lbs.</h5>
            
            <input class='weightsub-box' type='text' value='0' title='Total Weapon Weight' name='attr_total_weapon' hidden>
            <input class='weightsub-box' type='text' value='0' title='Total Armor Weight' name='attr_total_armor' hidden>
            <input class='weightsub-box' type='text' value='0' title='Total Gear Weight' name='attr_total_gear' hidden>
            <input class='weightsub-box' type='text' value='0' title='Total Consumables Weight' name='attr_total_consumables' hidden>
            <input class='weightsub-box' type='text' value='0' title='Total Wealth Weight' name='attr_total_wealth' hidden>
        </div>
        <div class="weapon-inventory-panel">
            <input type="checkbox" name="attr_weapon-toggle" class="sheet-arrow" />
            <h4>Weapons</h4>
            <div class="body">
                <fieldset class="repeating_weapon"> 
                    <div class='weapon-grid-container' >
                        <h5>Weapon</h5>
                        <h5>Length</h5>
                        <h5>Damage</h5>
                        <h5>Weight</h5>
                        <h5>Value</h5>
                        <h5>#</h5>
                        <div class='space-holder'></div>
                        
                        <input class='weapon-field' type="text" value="" name="attr_weapon_name" placeholder="Weapon Name" />
                        <input class='damage-dice' type="text" value="" name="attr_weapon_length" />
                        <input class='damage-dice' type="text" value="" name="attr_weapon_damage" placeholder="xdy+z" />
                        <input class='damage-dice' type="text" value="" name="attr_weapon_weight" />
                        <input class='weapon-field' type="number" value="" name="attr_weapon_value" />
                        <input class='counter' type='text' value='1' name='attr_weapon_count' />
                        <div class='space-holder'></div>
                        <textarea wrap="soft" class="weapon-textarea" value="" name="attr_weapon_details" placeholder="Weapon Details" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="armor-inventory-panel">
            <input type="checkbox" name="attr_armor-toggle" class="sheet-arrow" />
            <h4>Armor</h4>
            <div class='body'>
                <fieldset class="repeating_armor"> 
                    <div class='armor-grid-container' >
                        <h5>Armor</h5>
                        <h5>A.R.</h5>
                        <h5>S.D.C.</h5>
                        <h5>Weight</h5>
                        <h5>Value</h5>
                        <h5>#</h5>
                        <div class='space-holder'></div>
                        
                        <input class='armor-field' type="text" value="" name="attr_armor_name" placeholder="Armor Name" />
                        <input class='armor-field' type="number" value="" name="attr_armor_ar" />
                        <input class='armor-field' type="number" value="" name="attr_armor_sdc" />
                        <input class='damage-dice' type="text" value="" name="attr_armor_weight" />
                        <input class='armor-field' type="number" value="" name="attr_armor_value" />
                        <input class='counter' type='text' value='1' name='attr_armor_count' />
                        <div class='space-holder'></div>
                        <textarea wrap="soft" class='armor-textarea' value="" name="attr_armor_details" placeholder="Armor Details" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="gear-inventory-panel">
            <input type="checkbox" name="attr_gear-toggle" class="sheet-arrow" />
            <h4>Gear</h4>
            <div class='body'>
                <fieldset class="repeating_gear"> 
                    <div class='inventory-grid-container' >
                        <h5>Item</h5>
                        <h5>Reference</h5>
                        <h5>Location</h5>
                        <h5>Weight</h5>
                        <h5>#</h5>
                        <div class='space-holder'></div>
                        
                        <input class='gear-field' type="text" value="" name="attr_wealth_name" placeholder="Gear Name" />
                        <input class='gear-field' type="text" value="" name="attr_wealth_worth" placeholder="Book and page numbers"/>
                        <input class='gear-field' type="text" value="" name="attr_wealth_location" placeholder="Worn, pouch, bank, etc." />
                        <input class='damage-dice' type='text' value='0' name='attr_gear_weight' />
                        <input class='counter' type='text' value='1' name='attr_gear_count' />
                        <div class='space-holder'></div>
                        <textarea wrap="soft" class='inventory-textarea' value="" name="attr_wealth_details" placeholder="Gear details, if any" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="consumable-inventory-panel">
            <input type="checkbox" name="attr_consumable-toggle" class="sheet-arrow" />
            <h4>Consumables</h4>
            <div class="body">
                <fieldset class="repeating_consumables"> 
                    <div class='inventory-grid-container' >
                        <h5>Consumable Item</h5>
                        <h5>Reference</h5>
                        <h5>Location</h5>
                        <h5>Weight</h5>
                        <h5>#</h5>
                        <div class='space-holder'></div>
                        
                        <input class='consumable-field' type="text" value="" name="attr_wealth_name" placeholder="Consumable Name" />
                        <input class='consumable-field' type="text" value="" name="attr_wealth_worth" placeholder="Book and page numbers"/>
                        <input class='consumable-field' type="text" value="" name="attr_wealth_location" placeholder="Worn, pouch, bank, etc." />
                        <input class='damage-dice' type='text' value='0' name='attr_consumables_weight' />
                        <input class='counter' type='text' value='1' name='attr_consumables_count' />
                        <div class='space-holder'></div>
                        <textarea wrap="soft" class='inventory-textarea' value="" name="attr_wealth_details" placeholder="Consumable details, if any" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="wealth-inventory-panel">
            <input type="checkbox" name="attr_wealth-toggle" class="sheet-arrow" />
            <h4>Wealth</h4>
            <div class="body">
                <fieldset class="repeating_wealth"> 
                    <div class='inventory-grid-container' >
                        <h5>Wealth Entry</h5>
                        <h5>Value</h5>
                        <h5>Location</h5>
                        <h5>Weight</h5>
                        <h5>#</h5>
                        <div class='space-holder'></div>
                        
                        <input class='wealth-field' type="text" value="" name="attr_wealth_name" placeholder="Salary, cash, valuable, etc" />
                        <input class='wealth-field' type="text" value="" name="attr_wealth_worth" placeholder="Value"/>
                        <input class='wealth-field' type="text" value="" name="attr_wealth_location" placeholder="Wallet, pouch, bank, etc." />
                        <input class='damage-dice' type='text' value='0' name='attr_wealth_weight' />
                        <input class='counter' type='text' value='1' name='attr_wealth_count' />
                        <div class='space-holder'></div>
                        <textarea wrap="soft" class='inventory-textarea' value="" name="attr_wealth_details" placeholder="Wealth item details, if any" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
    </div>
    <!--Notes Tab-->
    <div class="sheet-journal">
        <h1>Notes</h1>
        <div class="note-one-panel">
            <input type="checkbox" name="attr_notes-toggle" class="sheet-arrow" />
            <h4>Notes</h4>
            <div class='body'>
                <fieldset class="repeating_notes"> 
                    <div class='notes-grid-container' >
                        <h4>Notes On</h4>
                        <input class='notes-field' type="text" value="" name="attr_notes_title" placeholder="Place, Person, or Topic" />
                        <div class="place-holder"></div>
                        <textarea wrap="soft" class='notes-textarea' value="" name="attr_notes_area" placeholder="Note Details" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="note-two-panel">
            <input type="checkbox" name="attr_notes_2-toggle" class="sheet-arrow" />
            <h4>Notes 2</h4>
            <div class='body'>
                <fieldset class="repeating_notes2"> 
                    <div class='second-notes-grid-container' >
                        <h4>Notes On</h4>
                        <input class='notes-field' type="text" value="" name="attr_notes_title" placeholder="Place, Person, or Topic" />
                        <div class="place-holder"></div>
                        <textarea wrap="soft" class='notes-textarea' value="" name="attr_notes_area" placeholder="Note Details" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div>
        <div class="note-three-panel">
            <input type="checkbox" name="attr_notes_3-toggle" class="sheet-arrow" />
            <h4>Notes 3</h4>
            <div class='body'>
                <fieldset class="repeating_notes3"> 
                    <div class='third-notes-grid-container' >
                        <h4>Notes On</h4>
                        <input class='notes-field' type="text" value="" name="attr_notes_title" placeholder="Place, Person, or Topic" />
                        <div class="place-holder"></div>
                        <textarea wrap="soft" class='notes-textarea' value="" name="attr_notes_area" placeholder="Note Details" /></textarea>
                    </div>            
                </fieldset>
            </div>
        </div> 
    </div>
    <!--Release Notes Tab-->
    <div class="sheet-release">
        <h1>Sheet Version: 1.0</h1>
        <h5>Recent Changes:</h5>
        <ul>
            <li>Changed the format of the repeating section buttons to fit better with the rest of the sheet.</li>
            <li>Changed the buttons on the melee and ranged sections to show full labels.</li>
            <li>Moved the temporary bonus fields to the top of each section and incorporated them into the roll buttons.  Those bonuses now apply to everything in the section under them.</li>
            <li>Made the input fields larger for regular bonuses to facilitate using row id references to weapon proficiency bonuses, and hid those fields on a second row made visible by a checkbox by each row.</li>
            <li>Added a notes field for saving throws that will display with every save roll except for Coma/Death.  This was added to provide a place for situational save bonuses that don't cover an entire category, such as the diabolist protection from hate ward.</li>
            <li>This (I think) wraps up everything I intended to do with the sheet.  This batch of changes live on Feb 18, '20.</li>
        </ul>
        <h5>Past Changes:</h5>
        <ul>
            <li>The sheet tabs have been altered to run on sheetworkers.</li>
            <li>The repeating attack entries on the statistics tab are now all text instead of number to allow entry of attributes instead of only numbers.  
            This allows the use of repeating section attributes to pull numbers from the weapon proficiencies on the combat tab.</li>
            <li>If there are any issues with the sheetworker tabs, I will revert back to a regular tab system.</li>
            <li>Hopefully this will be the final stabile version of this sheet.</li>
        </ul>
        <p>For more information on this sheet, check the page dedicated to it on the Roll20 wiki or the Readme on Github.  
        <button type="roll" class="statdice" name="roll_wiki" value="&{template:custom} {{color=black}} {{title=**Information Links**}} {{subtitle=Right Click Link to Open in a New Tab.}} {{desc=[Roll20 Wiki Palladium 1E](https://wiki.roll20.net/Palladium_Fantasy_1E)
[Github Readme](https://github.com/Roll20/roll20-character-sheets/tree/master/Palladium%20Fantasy%201E)}}" >Info Links</button></p>
    </div>
</div>
<script type="text/worker">
    const buttonlist = ["characterprofile1","socialtab2","skilltab3","combattab4","equipmenttab5","journaltab6","releasetab7","documentationtab8"];
    buttonlist.forEach(buttonlist => {
        on(`clicked:${buttonlist}`, function() {
            console.log(`${buttonlist} button was clicked!!`);
            let radioval = `${buttonlist}`;
            radioval = radioval.slice(-1);
            console.log(`Value for Radio Button is: ${radioval}`);
            setAttrs({ sheetTab: radioval });
            if (radioval === "7") {
                setAttrs({ newcontent: "read" });
            }
        });
    });
    on("change:iq sheet:opened", function () {
            getAttrs(['iq'], function (values) {
                const iq = parseInt(values['iq'])||0;
                let iq_bonus = 0;
                if(iq > 15) iq_bonus = Math.round(iq -14);
                setAttrs({
                    iq_bonus: iq_bonus
                });
            });
    });
    on("change:me sheet:opened", function () {
        getAttrs(['me'], function (values) {
            const mep = parseInt(values['me'])||0;
            const mei = parseInt(values['me'])||0;
            let me_psionic = 0;
            if (mep > 15) me_psionic = Math.round((mep -15)*.5);
            let me_insanity = 0;
            if (mei > 20) me_insanity = Math.round(mei -17);
            else if (mei > 15) me_insanity = me_insanity;
            setAttrs({
                me_psionic: me_psionic,
                me_insanity: me_insanity
            });
        });
    });
    function maMod(score) {
        let bonus = 0;
        if (score >= 30) bonus = 97;
        else if (score >= 29) bonus = 96;
        else if (score >= 28) bonus = 94;
        else if (score >= 27) bonus = 92;
        else if (score >= 26) bonus = 88;
        else if (score >= 25) bonus = 84;
        else if (score >= 16) bonus = Math.floor(score-8)*5;
        return bonus;
   }; 
    on("change:ma sheet:opened", function () {
        getAttrs(['ma'], function (values) {
            let ma = parseInt(values['ma'])||0;
            let invoke_trust = maMod(ma);
            setAttrs({                            
                invoke_trust: invoke_trust
            });
        });
    });
    on("change:ps sheet:opened", function () {
            getAttrs(['ps'], function (values) {
                const ps = parseInt(values['ps'])||0;
                const psx20 = ps*20;
                const psx10 = ps*10;
                let ps_bonus = 0;
                if(ps > 15) ps_bonus = Math.round(ps -15);
                setAttrs({
                    lift: psx20,
                    carry: psx10,
                    ps_bonus: ps_bonus
                });
            });
    });
    function ppMod(score) {
        let bonus = 0;
        if (score >= 16) bonus = Math.round((score-15)*.5);
        return bonus;
   }; 
    on("change:pp sheet:opened", function () {
        getAttrs(['pp'], function (values) {
            let pp = parseInt(values['pp'])||0;
            let pp_bonus = ppMod(pp);
            setAttrs({                            
                pp_bonus: pp_bonus
            });
        });
    });    
    on("change:pe sheet:opened", function () {
        getAttrs(['pe'], function (values) {
            const pe = parseInt(values['pe'])||0;
            const pec = pe;
            const per = pe;
            let pe_magpois = 0;
            if (pe > 15) pe_magpois = Math.round((pe -15)*.5);
            let pe_coma = 0;
            if (pe > 15) pe_coma = Math.round(pe -12);
            else if (pe > 17) pe_coma = Math.round((pe -15)*2);
            setAttrs({
                carry_max: pec,
                run_max: per,
                pe_magpois: pe_magpois,
                pe_coma: pe_coma
            });
        });
    }); 
    function pbMod(score) {
        let bonus = 0;
        if (score >= 30) bonus = 92;
        else if (score >= 27) bonus = (score *3) +3;
        else if (score >= 16) bonus = Math.floor(score-10)*5;
        return bonus;
   }; 
    on("change:pb sheet:opened", function () {
        getAttrs(['pb'], function (values) {
            let pb = parseInt(values['pb'])||0;
            let charm_impress = pbMod(pb);
            setAttrs({                            
                charm_impress: charm_impress
            });
        });
    }); 
    on("change:spd sheet:opened", function () {
        getAttrs(['spd'], function (values) {
            const spd = parseInt(values['spd'])||0;
            const runmel = spd*15;
            const runmil = Math.round(spd*.68);
            setAttrs({
                run_melee: runmel,
                run_mph: runmil
            });
        });
    }); 
    on("change:spd change:hth_numberattacks sheet:opened", function () {
        getAttrs(['spd','hth_numberattacks'], function (values) {
            const spd = parseInt(values['spd'])||0;
            const hth_numberattacks = parseInt(values['hth_numberattacks'])||0;
            const modifier = Math.round((spd/hth_numberattacks)*15); 
            setAttrs({
                run_attack: modifier
            });
        });
    });
    const repeatingSum = (destination, section, fields, multiplier = 1) => {
        if (!Array.isArray(fields)) fields = [fields];
        getSectionIDs(`repeating_${section}`, idArray => {
            const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
            getAttrs(attrArray, v => {
                console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                 // getValue: if not a number, returns 1 if it is 'on' (checkbox), otherwise returns 0..
                const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10) || (v[`repeating_${section}_${id}_${field}`] === 'on' ? 1 : 0); 
                const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
                setAttrs({[destination]: sumTotal * multiplier});    
            });
        });
    };
    on('change:repeating_weapon remove:repeating_weapon', function() {
        repeatingSum("total_weapon","weapon",["weapon_weight","weapon_count"]);
    });
    on('change:repeating_armor remove:repeating_armor', function() {
        repeatingSum("total_armor","armor",["armor_weight","armor_count"]);
    });
    on('change:repeating_gear remove:repeating_gear', function() {
        repeatingSum("total_gear","gear",["gear_weight","gear_count"]);
    });
    on('change:repeating_consumables remove:repeating_consumables', function() {
        repeatingSum("total_consumables","consumables",["consumables_weight","consumables_count"]);
    });
    on('change:repeating_wealth remove:repeating_wealth', function() {
        repeatingSum("total_wealth","wealth",["wealth_weight","wealth_count"]);
    });
    on("change:total_weapon change:total_armor change:total_gear change:total_consumables change:total_wealth", function () {
        getAttrs(['total_weapon','total_armor','total_gear','total_consumables','total_wealth'], function (values) {
            const total_weapon = parseInt(values['total_weapon'])||0;
            const total_armor = parseInt(values['total_armor'])||0;
            const total_gear = parseInt(values['total_gear'])||0;
            const total_consumables = parseInt(values['total_consumables'])||0;
            const total_wealth = parseInt(values['total_wealth'])||0;
            const total_weight = Math.round(total_weapon+total_armor+total_gear+total_consumables+total_wealth);
            setAttrs({
                total_weight: total_weight
            });
        });
    });    
</script>
<rolltemplate class="sheet-rolltemplate-custom">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color}}
      {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-menu">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color}}
      {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>
